<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>stereoVision: StereoCamera Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">stereoVision
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">StereoCamera Class Reference<div class="ingroups"><a class="el" href="group__StereoVisionLib.html">stereoVisionLib</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The base class defining stereo camera.  
 <a href="classStereoCamera.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="stereoCamera_8h_source.html">stereoCamera.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a11256fe5a509436abc714a594b6cc801"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a11256fe5a509436abc714a594b6cc801">StereoCamera</a> (bool rectify=true)</td></tr>
<tr class="memdesc:a11256fe5a509436abc714a594b6cc801"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Constructor.  <a href="#a11256fe5a509436abc714a594b6cc801">More...</a><br /></td></tr>
<tr class="separator:a11256fe5a509436abc714a594b6cc801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c2cd4c7b5a0cdb96370c29a42601f40"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a0c2cd4c7b5a0cdb96370c29a42601f40">StereoCamera</a> (yarp::os::ResourceFinder &amp;rf, bool rectify=true)</td></tr>
<tr class="memdesc:a0c2cd4c7b5a0cdb96370c29a42601f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Costructor for initialization from file.  <a href="#a0c2cd4c7b5a0cdb96370c29a42601f40">More...</a><br /></td></tr>
<tr class="separator:a0c2cd4c7b5a0cdb96370c29a42601f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bfcf3ef7c9d45802bacbf040e7ca112"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a5bfcf3ef7c9d45802bacbf040e7ca112">StereoCamera</a> (<a class="el" href="classCamera.html">Camera</a> First, <a class="el" href="classCamera.html">Camera</a> Second, bool rectify=true)</td></tr>
<tr class="memdesc:a5bfcf3ef7c9d45802bacbf040e7ca112"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for initialization using two calibrated cameras.  <a href="#a5bfcf3ef7c9d45802bacbf040e7ca112">More...</a><br /></td></tr>
<tr class="separator:a5bfcf3ef7c9d45802bacbf040e7ca112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398f45eeefe7979a834659cfbb7a6961"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a398f45eeefe7979a834659cfbb7a6961">stereoCalibration</a> (vector&lt; string &gt; imageList, int boardWidth, int boardHeight, float sqsize=1.0)</td></tr>
<tr class="memdesc:a398f45eeefe7979a834659cfbb7a6961"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the stereo camera calibration.  <a href="#a398f45eeefe7979a834659cfbb7a6961">More...</a><br /></td></tr>
<tr class="separator:a398f45eeefe7979a834659cfbb7a6961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f06cd4b170ad0ba45b681ee93d64851"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a9f06cd4b170ad0ba45b681ee93d64851">saveCalibration</a> (string extrinsicFilePath, string intrinsicFilePath)</td></tr>
<tr class="memdesc:a9f06cd4b170ad0ba45b681ee93d64851"><td class="mdescLeft">&#160;</td><td class="mdescRight">It saves the calibration.  <a href="#a9f06cd4b170ad0ba45b681ee93d64851">More...</a><br /></td></tr>
<tr class="separator:a9f06cd4b170ad0ba45b681ee93d64851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e24f7d17a11adb4a6310df7f7e2de5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a5e24f7d17a11adb4a6310df7f7e2de5b">setImages</a> (IplImage *firstImg, IplImage *secondImg)</td></tr>
<tr class="memdesc:a5e24f7d17a11adb4a6310df7f7e2de5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It stores in memory a couple of images.  <a href="#a5e24f7d17a11adb4a6310df7f7e2de5b">More...</a><br /></td></tr>
<tr class="separator:a5e24f7d17a11adb4a6310df7f7e2de5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e9e3dbbc6db7e7eb18fa0d9d84f7a6"><td class="memItemLeft" align="right" valign="top">cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a64e9e3dbbc6db7e7eb18fa0d9d84f7a6">findMatch</a> (bool visualize=false, double displacement=15, double radius=0.25)</td></tr>
<tr class="memdesc:a64e9e3dbbc6db7e7eb18fa0d9d84f7a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">It finds matches between two images.  <a href="#a64e9e3dbbc6db7e7eb18fa0d9d84f7a6">More...</a><br /></td></tr>
<tr class="separator:a64e9e3dbbc6db7e7eb18fa0d9d84f7a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79e986f2970bb2c5b5acd1ede65984aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a79e986f2970bb2c5b5acd1ede65984aa">computeDisparity</a> (bool best=true, int uniquenessRatio=15, int speckleWindowSize=50, int speckleRange=16, int numberOfDisparities=64, int SADWindowSize=7, int minDisparity=0, int preFilterCap=63, int disp12MaxDiff=0)</td></tr>
<tr class="memdesc:a79e986f2970bb2c5b5acd1ede65984aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">It computes the Disparity Map using H.  <a href="#a79e986f2970bb2c5b5acd1ede65984aa">More...</a><br /></td></tr>
<tr class="separator:a79e986f2970bb2c5b5acd1ede65984aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2751f357e5fabc7099303d45425208d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a2751f357e5fabc7099303d45425208d7">undistortImages</a> ()</td></tr>
<tr class="memdesc:a2751f357e5fabc7099303d45425208d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">It undistorts the images.  <a href="#a2751f357e5fabc7099303d45425208d7">More...</a><br /></td></tr>
<tr class="separator:a2751f357e5fabc7099303d45425208d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf155975709fdbf09d3133899d074a02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#adf155975709fdbf09d3133899d074a02">horn</a> (Mat &amp;K1, Mat &amp;K2, vector&lt; Point2f &gt; &amp;Points1, vector&lt; Point2f &gt; &amp;Points2, Mat &amp;Rot, Mat &amp;Tras)</td></tr>
<tr class="memdesc:adf155975709fdbf09d3133899d074a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the horn relative orientations algorithm i.e.  <a href="#adf155975709fdbf09d3133899d074a02">More...</a><br /></td></tr>
<tr class="separator:adf155975709fdbf09d3133899d074a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36dae897d07544e8faca8c90216173a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a36dae897d07544e8faca8c90216173a6">hornRelativeOrientations</a> ()</td></tr>
<tr class="memdesc:a36dae897d07544e8faca8c90216173a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the horn relative orientations, all the parameters are assumed initialized in the <a class="el" href="classStereoCamera.html" title="The base class defining stereo camera. ">StereoCamera</a> object.  <a href="#a36dae897d07544e8faca8c90216173a6">More...</a><br /></td></tr>
<tr class="separator:a36dae897d07544e8faca8c90216173a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c8ef84424fa111c63437a3db8f04333"><td class="memItemLeft" align="right" valign="top">Point3f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a3c8ef84424fa111c63437a3db8f04333">triangulation</a> (Point2f &amp;point1, Point2f &amp;point2)</td></tr>
<tr class="memdesc:a3c8ef84424fa111c63437a3db8f04333"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the triangulation using the stored in the internal P1 and P2 3x4 <a class="el" href="classCamera.html" title="The base class defining a simple camera. ">Camera</a> Matrices.  <a href="#a3c8ef84424fa111c63437a3db8f04333">More...</a><br /></td></tr>
<tr class="separator:a3c8ef84424fa111c63437a3db8f04333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab68c8d3bd07f542243d681fbe8c8c6b7"><td class="memItemLeft" align="right" valign="top">Point3f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#ab68c8d3bd07f542243d681fbe8c8c6b7">triangulation</a> (Point2f &amp;point1, Point2f &amp;point2, Mat Camera1, Mat Camera2)</td></tr>
<tr class="memdesc:ab68c8d3bd07f542243d681fbe8c8c6b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the triangulation (HZ Chap 12.2 homogenous solution).  <a href="#ab68c8d3bd07f542243d681fbe8c8c6b7">More...</a><br /></td></tr>
<tr class="separator:ab68c8d3bd07f542243d681fbe8c8c6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaef25d8723eefdbab6e27c348492126b"><td class="memItemLeft" align="right" valign="top">Point3f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#aaef25d8723eefdbab6e27c348492126b">triangulationLS</a> (Point2f &amp;point1, Point2f &amp;point2, Mat Camera1, Mat Camera2)</td></tr>
<tr class="memdesc:aaef25d8723eefdbab6e27c348492126b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the least square triangulation (HZ Chap 12.2 Inhomogenous solution).  <a href="#aaef25d8723eefdbab6e27c348492126b">More...</a><br /></td></tr>
<tr class="separator:aaef25d8723eefdbab6e27c348492126b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fcd3e1767bcf04716b0e2ac76098430"><td class="memItemLeft" align="right" valign="top">Point3f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a2fcd3e1767bcf04716b0e2ac76098430">metricTriangulation</a> (Point2f &amp;point1, double thMeters=10)</td></tr>
<tr class="memdesc:a2fcd3e1767bcf04716b0e2ac76098430"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the metric triangulation given the pixel coordinates on the first image.  <a href="#a2fcd3e1767bcf04716b0e2ac76098430">More...</a><br /></td></tr>
<tr class="separator:a2fcd3e1767bcf04716b0e2ac76098430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cf53fac6336eea107a26bd5cdbbdd03"><td class="memItemLeft" align="right" valign="top">Point3f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a3cf53fac6336eea107a26bd5cdbbdd03">metricTriangulation</a> (Point2f &amp;point1, Mat &amp;H, double thMeters=10)</td></tr>
<tr class="memdesc:a3cf53fac6336eea107a26bd5cdbbdd03"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the metric triangulation given the pixel coordinates on the first image.  <a href="#a3cf53fac6336eea107a26bd5cdbbdd03">More...</a><br /></td></tr>
<tr class="separator:a3cf53fac6336eea107a26bd5cdbbdd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a761ea623c4cde38b4fa1d798ef09b7ae"><td class="memItemLeft" align="right" valign="top">Point3f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a761ea623c4cde38b4fa1d798ef09b7ae">triangulateKnownDisparity</a> (float u, float v, float d, Mat &amp;H)</td></tr>
<tr class="memdesc:a761ea623c4cde38b4fa1d798ef09b7ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the metric triangulation given the pixel coordinates on the first image and the disparity between the two RECTIFIED images.  <a href="#a761ea623c4cde38b4fa1d798ef09b7ae">More...</a><br /></td></tr>
<tr class="separator:a761ea623c4cde38b4fa1d798ef09b7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2eded08bca185ac22cd6343cb4c85c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#ab2eded08bca185ac22cd6343cb4c85c8">estimateEssential</a> ()</td></tr>
<tr class="memdesc:ab2eded08bca185ac22cd6343cb4c85c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">It estimates the essential matrix (3x3) E between two views.  <a href="#ab2eded08bca185ac22cd6343cb4c85c8">More...</a><br /></td></tr>
<tr class="separator:ab2eded08bca185ac22cd6343cb4c85c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a180388e93b654802c7c56c18d206214b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a180388e93b654802c7c56c18d206214b">essentialDecomposition</a> ()</td></tr>
<tr class="memdesc:a180388e93b654802c7c56c18d206214b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It decomposes the essential matrix in Rotation and Translation between the two views.  <a href="#a180388e93b654802c7c56c18d206214b">More...</a><br /></td></tr>
<tr class="separator:a180388e93b654802c7c56c18d206214b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245346dbef63e13807c5cd9160803d25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a245346dbef63e13807c5cd9160803d25">chierality</a> (Mat &amp;R1, Mat &amp;R2, Mat &amp;t1, Mat &amp;t2, Mat &amp;R, Mat &amp;t, Vector&lt; Point2f &gt; points1, Vector&lt; Point2f &gt; points2)</td></tr>
<tr class="memdesc:a245346dbef63e13807c5cd9160803d25"><td class="mdescLeft">&#160;</td><td class="mdescRight">It performs the chierality test: given a couple of rotation matrices, translation vectors and matches it finds the correct rotation and translation s.t.  <a href="#a245346dbef63e13807c5cd9160803d25">More...</a><br /></td></tr>
<tr class="separator:a245346dbef63e13807c5cd9160803d25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d155d519c621a7a580f41ec114df01"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a57d155d519c621a7a580f41ec114df01">getImLeft</a> ()</td></tr>
<tr class="memdesc:a57d155d519c621a7a580f41ec114df01"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the left (first) image.  <a href="#a57d155d519c621a7a580f41ec114df01">More...</a><br /></td></tr>
<tr class="separator:a57d155d519c621a7a580f41ec114df01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e72c3430250883aac6ab5a4d98961f"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a09e72c3430250883aac6ab5a4d98961f">getImRight</a> ()</td></tr>
<tr class="memdesc:a09e72c3430250883aac6ab5a4d98961f"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the right (second) image.  <a href="#a09e72c3430250883aac6ab5a4d98961f">More...</a><br /></td></tr>
<tr class="separator:a09e72c3430250883aac6ab5a4d98961f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ff47fc8326d511677bef8bcf3a65bc"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a48ff47fc8326d511677bef8bcf3a65bc">getImLeftUnd</a> ()</td></tr>
<tr class="memdesc:a48ff47fc8326d511677bef8bcf3a65bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the left undistorted image.  <a href="#a48ff47fc8326d511677bef8bcf3a65bc">More...</a><br /></td></tr>
<tr class="separator:a48ff47fc8326d511677bef8bcf3a65bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0485caf9bd52a7317776e5db495446a5"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a0485caf9bd52a7317776e5db495446a5">getImRightUnd</a> ()</td></tr>
<tr class="memdesc:a0485caf9bd52a7317776e5db495446a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the right undistorted image.  <a href="#a0485caf9bd52a7317776e5db495446a5">More...</a><br /></td></tr>
<tr class="separator:a0485caf9bd52a7317776e5db495446a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97607922d84e1a1a006cd7a5aec93a24"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a97607922d84e1a1a006cd7a5aec93a24">getDisparity</a> ()</td></tr>
<tr class="memdesc:a97607922d84e1a1a006cd7a5aec93a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the disparity image.  <a href="#a97607922d84e1a1a006cd7a5aec93a24">More...</a><br /></td></tr>
<tr class="separator:a97607922d84e1a1a006cd7a5aec93a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f9890f50d85be9ebda7a0769279348"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a89f9890f50d85be9ebda7a0769279348">getDisparity16</a> ()</td></tr>
<tr class="memdesc:a89f9890f50d85be9ebda7a0769279348"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the disparity image.  <a href="#a89f9890f50d85be9ebda7a0769279348">More...</a><br /></td></tr>
<tr class="separator:a89f9890f50d85be9ebda7a0769279348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43bd5710058d9ee0ed94dc8b74e5656c"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a43bd5710058d9ee0ed94dc8b74e5656c">getQ</a> ()</td></tr>
<tr class="memdesc:a43bd5710058d9ee0ed94dc8b74e5656c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the 4x4 disparity-to-depth mapping matrix.  <a href="#a43bd5710058d9ee0ed94dc8b74e5656c">More...</a><br /></td></tr>
<tr class="separator:a43bd5710058d9ee0ed94dc8b74e5656c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8533ec543166868e3db471bad0cb61a3"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a8533ec543166868e3db471bad0cb61a3">getKleft</a> ()</td></tr>
<tr class="memdesc:a8533ec543166868e3db471bad0cb61a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the 3x3 left camera matrix.  <a href="#a8533ec543166868e3db471bad0cb61a3">More...</a><br /></td></tr>
<tr class="separator:a8533ec543166868e3db471bad0cb61a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ea986b40a785e589704bb58750e15b"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a62ea986b40a785e589704bb58750e15b">getKright</a> ()</td></tr>
<tr class="memdesc:a62ea986b40a785e589704bb58750e15b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the 3x3 right camera matrix.  <a href="#a62ea986b40a785e589704bb58750e15b">More...</a><br /></td></tr>
<tr class="separator:a62ea986b40a785e589704bb58750e15b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a257d9f531c444b685a0b96ae3908c2d0"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a257d9f531c444b685a0b96ae3908c2d0">getFundamental</a> ()</td></tr>
<tr class="memdesc:a257d9f531c444b685a0b96ae3908c2d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the 3x3 fundamental matrix.  <a href="#a257d9f531c444b685a0b96ae3908c2d0">More...</a><br /></td></tr>
<tr class="separator:a257d9f531c444b685a0b96ae3908c2d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac42cf4193f379a3c0ecf5e40c61358f2"><td class="memItemLeft" align="right" valign="top">const vector&lt; Point2f &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#ac42cf4193f379a3c0ecf5e40c61358f2">getMatchLeft</a> ()</td></tr>
<tr class="memdesc:ac42cf4193f379a3c0ecf5e40c61358f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the pixel coordinates of the matches in the left image.  <a href="#ac42cf4193f379a3c0ecf5e40c61358f2">More...</a><br /></td></tr>
<tr class="separator:ac42cf4193f379a3c0ecf5e40c61358f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab35a9b702cd5213bd8d4de8491399201"><td class="memItemLeft" align="right" valign="top">const vector&lt; Point2f &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#ab35a9b702cd5213bd8d4de8491399201">getMatchRight</a> ()</td></tr>
<tr class="memdesc:ab35a9b702cd5213bd8d4de8491399201"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the pixel coordinates of the matches in the right image.  <a href="#ab35a9b702cd5213bd8d4de8491399201">More...</a><br /></td></tr>
<tr class="separator:ab35a9b702cd5213bd8d4de8491399201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7df54191a3c73486c0136de18dd52e"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a7c7df54191a3c73486c0136de18dd52e">getTranslation</a> ()</td></tr>
<tr class="memdesc:a7c7df54191a3c73486c0136de18dd52e"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the translation vector between the two cameras.  <a href="#a7c7df54191a3c73486c0136de18dd52e">More...</a><br /></td></tr>
<tr class="separator:a7c7df54191a3c73486c0136de18dd52e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13fc8d5d205e09ab3d1bb8010829b0c1"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a13fc8d5d205e09ab3d1bb8010829b0c1">getRotation</a> ()</td></tr>
<tr class="memdesc:a13fc8d5d205e09ab3d1bb8010829b0c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the rotation matrix between the two cameras.  <a href="#a13fc8d5d205e09ab3d1bb8010829b0c1">More...</a><br /></td></tr>
<tr class="separator:a13fc8d5d205e09ab3d1bb8010829b0c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7a3361adfda3a05eea2d5116ed2515"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a6d7a3361adfda3a05eea2d5116ed2515">getMapperL</a> ()</td></tr>
<tr class="memdesc:a6d7a3361adfda3a05eea2d5116ed2515"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the mapping between the original left camera and the rectified left camera.  <a href="#a6d7a3361adfda3a05eea2d5116ed2515">More...</a><br /></td></tr>
<tr class="separator:a6d7a3361adfda3a05eea2d5116ed2515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cbd829aba62360200035bb452edc42b"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a8cbd829aba62360200035bb452edc42b">getMapperR</a> ()</td></tr>
<tr class="memdesc:a8cbd829aba62360200035bb452edc42b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the mapping between the original right camera and the rectified right camera.  <a href="#a8cbd829aba62360200035bb452edc42b">More...</a><br /></td></tr>
<tr class="separator:a8cbd829aba62360200035bb452edc42b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986686c56d4bf5381ea57b3f49338af1"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">getRLrect</a> ()</td></tr>
<tr class="memdesc:a986686c56d4bf5381ea57b3f49338af1"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the rotation matrix between the original left camera and the rectified left camera.  <a href="#a986686c56d4bf5381ea57b3f49338af1">More...</a><br /></td></tr>
<tr class="separator:a986686c56d4bf5381ea57b3f49338af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08979926b86d513f1b373109f5a4733d"><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a08979926b86d513f1b373109f5a4733d">getRRrect</a> ()</td></tr>
<tr class="memdesc:a08979926b86d513f1b373109f5a4733d"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the rotation matrix between the original right camera and the rectified right camera.  <a href="#a08979926b86d513f1b373109f5a4733d">More...</a><br /></td></tr>
<tr class="separator:a08979926b86d513f1b373109f5a4733d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1329b3894d527e1505618f57a1304624"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a1329b3894d527e1505618f57a1304624">setRotation</a> (Mat &amp;Rot, int mode=0)</td></tr>
<tr class="memdesc:a1329b3894d527e1505618f57a1304624"><td class="mdescLeft">&#160;</td><td class="mdescRight">It sets the rotation matrix (if known) between the first and the second camera.  <a href="#a1329b3894d527e1505618f57a1304624">More...</a><br /></td></tr>
<tr class="separator:a1329b3894d527e1505618f57a1304624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b10f1218e8e70f47b22080ba1820d39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a7b10f1218e8e70f47b22080ba1820d39">setTranslation</a> (Mat &amp;Tras, int mul=0)</td></tr>
<tr class="memdesc:a7b10f1218e8e70f47b22080ba1820d39"><td class="mdescLeft">&#160;</td><td class="mdescRight">It sets the translation vector (if known) between the first and the second camera.  <a href="#a7b10f1218e8e70f47b22080ba1820d39">More...</a><br /></td></tr>
<tr class="separator:a7b10f1218e8e70f47b22080ba1820d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54754623497c8dddb61f520e17f465f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a54754623497c8dddb61f520e17f465f8">setIntrinsics</a> (Mat &amp;K1, Mat &amp;K2, Mat &amp;Dist1, Mat &amp;Dist2)</td></tr>
<tr class="memdesc:a54754623497c8dddb61f520e17f465f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">It sets the intrinsic parameters.  <a href="#a54754623497c8dddb61f520e17f465f8">More...</a><br /></td></tr>
<tr class="separator:a54754623497c8dddb61f520e17f465f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ac866c6d4b6c4819b01a918e7b61e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#ae5ac866c6d4b6c4819b01a918e7b61e0">rectifyImages</a> ()</td></tr>
<tr class="memdesc:ae5ac866c6d4b6c4819b01a918e7b61e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method rectifies the two images: it transform each image plane such that pairs conjugate epipolar lines become collinear and parallel to one of the image axes (i.e.  <a href="#ae5ac866c6d4b6c4819b01a918e7b61e0">More...</a><br /></td></tr>
<tr class="separator:ae5ac866c6d4b6c4819b01a918e7b61e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd4492f7f87862955da0bc5d0042cc8"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a0bd4492f7f87862955da0bc5d0042cc8">getLRectified</a> ()</td></tr>
<tr class="memdesc:a0bd4492f7f87862955da0bc5d0042cc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method returns the first rectified image.  <a href="#a0bd4492f7f87862955da0bc5d0042cc8">More...</a><br /></td></tr>
<tr class="separator:a0bd4492f7f87862955da0bc5d0042cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf4ba8eaa338ff24db1196849a96e5e9"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#aaf4ba8eaa338ff24db1196849a96e5e9">getRRectified</a> ()</td></tr>
<tr class="memdesc:aaf4ba8eaa338ff24db1196849a96e5e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method returns the second rectified image.  <a href="#aaf4ba8eaa338ff24db1196849a96e5e9">More...</a><br /></td></tr>
<tr class="separator:aaf4ba8eaa338ff24db1196849a96e5e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03406c9d31c1b765a8d6ef9641222309"><td class="memItemLeft" align="right" valign="top">vector&lt; Point2f &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a03406c9d31c1b765a8d6ef9641222309">projectPoints3D</a> (string camera, vector&lt; Point3f &gt; &amp;points3D, Mat &amp;H)</td></tr>
<tr class="memdesc:a03406c9d31c1b765a8d6ef9641222309"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method returns the 2D projection of a set of 3D points in the cartesian space to the specified camera.  <a href="#a03406c9d31c1b765a8d6ef9641222309">More...</a><br /></td></tr>
<tr class="separator:a03406c9d31c1b765a8d6ef9641222309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ef2f3401488e5c4fa6badd1336f96d"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a52ef2f3401488e5c4fa6badd1336f96d">computeWorldImage</a> (Mat &amp;H)</td></tr>
<tr class="memdesc:a52ef2f3401488e5c4fa6badd1336f96d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method returns a 3-Channels float image with the world coordinates w.r.t H reference system.  <a href="#a52ef2f3401488e5c4fa6badd1336f96d">More...</a><br /></td></tr>
<tr class="separator:a52ef2f3401488e5c4fa6badd1336f96d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3edeb24b68ee4266f89982533ad1e9bf"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a3edeb24b68ee4266f89982533ad1e9bf">getDistCoeffRight</a> ()</td></tr>
<tr class="memdesc:a3edeb24b68ee4266f89982533ad1e9bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the 5x1 right distortion coefficients.  <a href="#a3edeb24b68ee4266f89982533ad1e9bf">More...</a><br /></td></tr>
<tr class="separator:a3edeb24b68ee4266f89982533ad1e9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4830201154ab288bd93f6cceb2c2daf5"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a4830201154ab288bd93f6cceb2c2daf5">getDistCoeffLeft</a> ()</td></tr>
<tr class="memdesc:a4830201154ab288bd93f6cceb2c2daf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">It returns the 5x1 left distortion coefficients.  <a href="#a4830201154ab288bd93f6cceb2c2daf5">More...</a><br /></td></tr>
<tr class="separator:a4830201154ab288bd93f6cceb2c2daf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af64550bb8a7a665930dee5eea87b7e47"><td class="memItemLeft" align="right" valign="top">Point2f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#af64550bb8a7a665930dee5eea87b7e47">getDistortedPixel</a> (int u, int v, int cam=1)</td></tr>
<tr class="memdesc:af64550bb8a7a665930dee5eea87b7e47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the u,v pixel coordinates in the undistorted image the method returns the original position of the pixel in the distorted frame.  <a href="#af64550bb8a7a665930dee5eea87b7e47">More...</a><br /></td></tr>
<tr class="separator:af64550bb8a7a665930dee5eea87b7e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6580ff03c7cec5c385ec717f9c018e21"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a6580ff03c7cec5c385ec717f9c018e21">drawMatches</a> ()</td></tr>
<tr class="memdesc:a6580ff03c7cec5c385ec717f9c018e21"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method returns a 3-Channels 8bit image with the image matches.  <a href="#a6580ff03c7cec5c385ec717f9c018e21">More...</a><br /></td></tr>
<tr class="separator:a6580ff03c7cec5c385ec717f9c018e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae683fafa11ea73e4b4c278402be259b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#ae683fafa11ea73e4b4c278402be259b6">setMatches</a> (std::vector&lt; cv::Point2f &gt; &amp;pointsL, std::vector&lt; cv::Point2f &gt; &amp;pointsR)</td></tr>
<tr class="memdesc:ae683fafa11ea73e4b4c278402be259b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function initialize the matches of the current image pair.  <a href="#ae683fafa11ea73e4b4c278402be259b6">More...</a><br /></td></tr>
<tr class="separator:ae683fafa11ea73e4b4c278402be259b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ecb303d7b36eaf5f086d8ddebd29b95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a9ecb303d7b36eaf5f086d8ddebd29b95">setExpectedPosition</a> (Mat &amp;Rot, Mat &amp;Tran)</td></tr>
<tr class="memdesc:a9ecb303d7b36eaf5f086d8ddebd29b95"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function set the expected Rotation and Translation parameters for the current image pair.  <a href="#a9ecb303d7b36eaf5f086d8ddebd29b95">More...</a><br /></td></tr>
<tr class="separator:a9ecb303d7b36eaf5f086d8ddebd29b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fe4e87322f8644cd21ce06e8522c815"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a3fe4e87322f8644cd21ce06e8522c815">FfromP</a> (Mat &amp;P1, Mat &amp;P2)</td></tr>
<tr class="memdesc:a3fe4e87322f8644cd21ce06e8522c815"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function computes the fundamental matrix starting from known camera matrices.  <a href="#a3fe4e87322f8644cd21ce06e8522c815">More...</a><br /></td></tr>
<tr class="separator:a3fe4e87322f8644cd21ce06e8522c815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d8fde0cbd4604085b883f22cc606c01"><td class="memItemLeft" align="right" valign="top">Point2f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStereoCamera.html#a3d8fde0cbd4604085b883f22cc606c01">fromRectifiedToOriginal</a> (int u, int v, int camera)</td></tr>
<tr class="memdesc:a3d8fde0cbd4604085b883f22cc606c01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the u,v pixel coordinates in the rectified image the method returns the position of the pixel in the non-rectified frame.  <a href="#a3d8fde0cbd4604085b883f22cc606c01">More...</a><br /></td></tr>
<tr class="separator:a3d8fde0cbd4604085b883f22cc606c01"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The base class defining stereo camera. </p>
<p>It allows to calibrate the cameras, to undistort a pair of images, to find matches between two images, to triangulate points and to estimate motion between two images. The basic assumption is that the two images come from a stereo camera, however this class works also with two arbitrary images. </p>

<p>Definition at line <a class="el" href="stereoCamera_8h_source.html#l00088">88</a> of file <a class="el" href="stereoCamera_8h_source.html">stereoCamera.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a11256fe5a509436abc714a594b6cc801"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">StereoCamera::StereoCamera </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rectify</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default Constructor. </p>
<p>You should initialize all the intrinsic and extrinsic parameters using the provided methods. </p>

<p>Definition at line <a class="el" href="stereoCamera_8h_source.html#l00177">177</a> of file <a class="el" href="stereoCamera_8h_source.html">stereoCamera.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{this-&gt;mutex=<span class="keyword">new</span> Semaphore(1); this-&gt;rectify=rectify;  this-&gt;epipolarTh=0.01; }; </div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0c2cd4c7b5a0cdb96370c29a42601f40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StereoCamera::StereoCamera </td>
          <td>(</td>
          <td class="paramtype">yarp::os::ResourceFinder &amp;&#160;</td>
          <td class="paramname"><em>rf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rectify</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Costructor for initialization from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rf</td><td>is the config file generated by the stereoCalib module. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00054">54</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l01861">setIntrinsics()</a>, <a class="el" href="stereoCamera_8cpp_source.html#l01404">setRotation()</a>, and <a class="el" href="stereoCamera_8cpp_source.html#l01419">setTranslation()</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                                                 {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        Mat KL, KR, DistL, DistR, R, T;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        loadStereoParameters(rf,KL,KR,DistL,DistR,R,T);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        this-&gt;mutex= <span class="keyword">new</span> Semaphore(1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        this-&gt;<a class="code" href="classStereoCamera.html#a54754623497c8dddb61f520e17f465f8">setIntrinsics</a>(KL,KR,DistL,DistR);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        this-&gt;<a class="code" href="classStereoCamera.html#a1329b3894d527e1505618f57a1304624">setRotation</a>(R,0);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        this-&gt;<a class="code" href="classStereoCamera.html#a7b10f1218e8e70f47b22080ba1820d39">setTranslation</a>(T,0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        this-&gt;cameraChanged=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        this-&gt;epipolarTh=0.01;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        this-&gt;rectify=rectify;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        buildUndistortRemap();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a1329b3894d527e1505618f57a1304624"><div class="ttname"><a href="classStereoCamera.html#a1329b3894d527e1505618f57a1304624">StereoCamera::setRotation</a></div><div class="ttdeci">void setRotation(Mat &amp;Rot, int mode=0)</div><div class="ttdoc">It sets the rotation matrix (if known) between the first and the second camera. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01404">stereoCamera.cpp:1404</a></div></div>
<div class="ttc" id="classStereoCamera_html_a7b10f1218e8e70f47b22080ba1820d39"><div class="ttname"><a href="classStereoCamera.html#a7b10f1218e8e70f47b22080ba1820d39">StereoCamera::setTranslation</a></div><div class="ttdeci">void setTranslation(Mat &amp;Tras, int mul=0)</div><div class="ttdoc">It sets the translation vector (if known) between the first and the second camera. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01419">stereoCamera.cpp:1419</a></div></div>
<div class="ttc" id="classStereoCamera_html_a54754623497c8dddb61f520e17f465f8"><div class="ttname"><a href="classStereoCamera.html#a54754623497c8dddb61f520e17f465f8">StereoCamera::setIntrinsics</a></div><div class="ttdeci">void setIntrinsics(Mat &amp;K1, Mat &amp;K2, Mat &amp;Dist1, Mat &amp;Dist2)</div><div class="ttdoc">It sets the intrinsic parameters. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01861">stereoCamera.cpp:1861</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5bfcf3ef7c9d45802bacbf040e7ca112"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StereoCamera::StereoCamera </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCamera.html">Camera</a>&#160;</td>
          <td class="paramname"><em>First</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCamera.html">Camera</a>&#160;</td>
          <td class="paramname"><em>Second</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rectify</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for initialization using two calibrated cameras. </p>
<dl class="section note"><dt>Note</dt><dd>Only intrinsic parameters are initialized. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">First</td><td>the first camera (Left eye is assumed but you can use any arbitrary camera). The 3D point coordinates have this reference system. </td></tr>
    <tr><td class="paramname">Second</td><td>the second camera (Right eye is assumed). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00068">68</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="camera_8cpp_source.html#l00260">Camera::getCameraMatrix()</a>, and <a class="el" href="camera_8cpp_source.html#l00263">Camera::getDistVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                                                 {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    this-&gt;Kleft=Left.getCameraMatrix();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    this-&gt;DistL=Left.getDistVector();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    this-&gt;Kright=Right.getCameraMatrix();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    this-&gt;DistR=Right.getDistVector();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    this-&gt;mutex=<span class="keyword">new</span> Semaphore(1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    this-&gt;cameraChanged=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    this-&gt;rectify=rectify;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    this-&gt;epipolarTh=0.01;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    buildUndistortRemap();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a245346dbef63e13807c5cd9160803d25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::chierality </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>R1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>R2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; Point2f &gt;&#160;</td>
          <td class="paramname"><em>points1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; Point2f &gt;&#160;</td>
          <td class="paramname"><em>points2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the chierality test: given a couple of rotation matrices, translation vectors and matches it finds the correct rotation and translation s.t. </p>
<p>the triangulated points have their depth coordinates greater than 0. The method is used by essentialDecomposition, indeed an essential matrix generates 2 rotations and 2 translation. The chierality test is needed in order to discard wrong rototranslations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">R1</td><td>first rotation 3x3 matrix </td></tr>
    <tr><td class="paramname">R2</td><td>second rotation 3x3 matrix </td></tr>
    <tr><td class="paramname">t1</td><td>first translation 3x1 matrix </td></tr>
    <tr><td class="paramname">t2</td><td>second translation 3x1 matrix </td></tr>
    <tr><td class="paramname">R</td><td>output rotation matrix </td></tr>
    <tr><td class="paramname">t</td><td>output translation matrix </td></tr>
    <tr><td class="paramname">points1</td><td>corrispondences in the first image </td></tr>
    <tr><td class="paramname">points2</td><td>corrispondences in the second image </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01044">1044</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l00681">triangulation()</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l00903">essentialDecomposition()</a>.</p>
<div class="fragment"><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                                                                                                                      {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        Mat A= Mat::eye(3,4,CV_64FC1);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        Mat P1 = this-&gt;Kleft*Mat::eye(3, 4, CV_64F);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; R1.rows; i++)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;             <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;             <span class="keywordtype">double</span>* MRi = R1.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; R1.cols; j++)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                     Mi[j]=MRi[j];</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;         }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;         </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; t1.rows; i++)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;         {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;             <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;             <span class="keywordtype">double</span>* MRi = t1.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;             Mi[3]=MRi[0];</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;         }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        Mat P2=this-&gt;Kright*A;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        A= Mat::eye(3,4,CV_64FC1);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; R2.rows; i++)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;         {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;             <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;             <span class="keywordtype">double</span>* MRi = R2.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; R2.cols; j++)</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                     Mi[j]=MRi[j];</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;         }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; t2.rows; i++)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;         {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;             <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;             <span class="keywordtype">double</span>* MRi = t2.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;             Mi[3]=MRi[0];</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;         }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        Mat P3=this-&gt;Kright*A;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        A= Mat::eye(3,4,CV_64FC1);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; R1.rows; i++)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;         {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;             <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;             <span class="keywordtype">double</span>* MRi = R1.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; R1.cols; j++)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                     Mi[j]=MRi[j];</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;         }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; t1.rows; i++)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;         {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;             <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;             <span class="keywordtype">double</span>* MRi = t2.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;             Mi[3]=MRi[0];</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;         }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        Mat P4=this-&gt;Kright*A;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        A= Mat::eye(3,4,CV_64FC1);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; R2.rows; i++)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;     {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;         <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;         <span class="keywordtype">double</span>* MRi = R2.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; R2.cols; j++)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                 Mi[j]=MRi[j];</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;     }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; t2.rows; i++)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;     {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;         <span class="keywordtype">double</span>* Mi = A.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;         <span class="keywordtype">double</span>* MRi = t1.ptr&lt;<span class="keywordtype">double</span>&gt;(i);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;         Mi[3]=MRi[0];</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;     }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;     Mat P5=this-&gt;Kright*A;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;     <span class="keywordtype">int</span> err1=0; <span class="comment">//R1 t1</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;     <span class="keywordtype">int</span> err2=0; <span class="comment">//R2 t2</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;     <span class="keywordtype">int</span> err3=0; <span class="comment">//R1 t2</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;     <span class="keywordtype">int</span> err4=0; <span class="comment">//R2 t1</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;     Mat point(4,1,CV_64FC1);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int) InliersL.size(); i++) </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;             Point3f point3D=<a class="code" href="classStereoCamera.html#a3c8ef84424fa111c63437a3db8f04333">triangulation</a>(points1[i],points2[i],P1,P2);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;             Mat H1=buildRotTras(R1,t1);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point3D.x;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point3D.y;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point3D.z;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=1.0;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;             Mat rotatedPoint=H1*point;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;             <span class="comment">//fprintf(stdout, &quot;Camera P2 Point3D: %f %f %f Rotated Point: %f %f %f \n&quot;, point3D.x,point3D.y,point3D.z, rotatedPoint.at&lt;double&gt;(0,0),rotatedPoint.at&lt;double&gt;(1,0),rotatedPoint.at&lt;double&gt;(2,0));</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;             <span class="keywordflow">if</span>(point3D.z&lt;0 || rotatedPoint.at&lt;<span class="keywordtype">double</span>&gt;(2,0)&lt;0) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                 err1++;                 </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;             }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;             point3D=<a class="code" href="classStereoCamera.html#a3c8ef84424fa111c63437a3db8f04333">triangulation</a>(points1[i],points2[i],P1,P3);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;             Mat H2=buildRotTras(R2,t2);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point3D.x;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point3D.y;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point3D.z;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=1.0;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;             rotatedPoint=H2*point;  </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;             <span class="comment">//fprintf(stdout, &quot;Camera P3 Point3D: %f %f %f Rotated Point: %f %f %f \n&quot;, point3D.x,point3D.y,point3D.z, rotatedPoint.at&lt;double&gt;(0,0),rotatedPoint.at&lt;double&gt;(1,0),rotatedPoint.at&lt;double&gt;(2,0));</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;             <span class="keywordflow">if</span>(point3D.z&lt;0 || rotatedPoint.at&lt;<span class="keywordtype">double</span>&gt;(2,0)&lt;0) {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                 err2++;                 </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;             }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                          </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;             point3D=<a class="code" href="classStereoCamera.html#a3c8ef84424fa111c63437a3db8f04333">triangulation</a>(points1[i],points2[i],P1,P4);   </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;             Mat H3=buildRotTras(R1,t2);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point3D.x;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point3D.y;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point3D.z;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=1.0;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;             rotatedPoint=H3*point;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;             <span class="comment">//fprintf(stdout, &quot;Camera P4 Point3D: %f %f %f Rotated Point: %f %f %f \n&quot;, point3D.x,point3D.y,point3D.z, rotatedPoint.at&lt;double&gt;(0,0),rotatedPoint.at&lt;double&gt;(1,0),rotatedPoint.at&lt;double&gt;(2,0));</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;             <span class="keywordflow">if</span>(point3D.z&lt;0 || rotatedPoint.at&lt;<span class="keywordtype">double</span>&gt;(2,0)&lt;0) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                 err3++;                 </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;             } </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;             </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;             point3D=<a class="code" href="classStereoCamera.html#a3c8ef84424fa111c63437a3db8f04333">triangulation</a>(points1[i],points2[i],P1,P5);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;             Mat H4=buildRotTras(R2,t1);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point3D.x;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point3D.y;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point3D.z;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;             point.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=1.0;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;             rotatedPoint=H4*point;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;             <span class="comment">//fprintf(stdout, &quot;Camera P5 Point3D: %f %f %f Rotated Point: %f %f %f \n&quot;, point3D.x,point3D.y,point3D.z, rotatedPoint.at&lt;double&gt;(0,0),rotatedPoint.at&lt;double&gt;(1,0),rotatedPoint.at&lt;double&gt;(2,0));</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;             </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;             <span class="keywordflow">if</span>(point3D.z&lt;0 || rotatedPoint.at&lt;<span class="keywordtype">double</span>&gt;(2,0)&lt;0) {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                 err4++;                 </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;             } </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;         }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">/*printMatrix(R1);</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">    printMatrix(t1);</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">    printMatrix(R2);</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">    printMatrix(t2);*/</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">//fprintf(stdout, &quot;Inliers: %d, %d, \n&quot;,points1.size(),points2.size());</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">//fprintf(stdout, &quot;errors: %d, %d, %d, %d, \n&quot;,err1,err2,err3,err4);</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordtype">double</span> minErr=10000;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordtype">double</span> secondErr=minErr;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordtype">int</span> idx=0;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">if</span>(err1&lt;minErr &amp;&amp; t1.ptr&lt;<span class="keywordtype">double</span>&gt;(0)[0]&lt;0)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        idx=1;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        secondErr=minErr;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        minErr=err1;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keywordflow">if</span>(err2&lt;minErr &amp;&amp; t2.ptr&lt;<span class="keywordtype">double</span>&gt;(0)[0]&lt;0)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        idx=2;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        secondErr=minErr;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        minErr=err2;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      } </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">if</span>(err3&lt;minErr &amp;&amp; t2.ptr&lt;<span class="keywordtype">double</span>&gt;(0)[0]&lt;0)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        idx=3;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        secondErr=minErr;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        minErr=err3;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keywordflow">if</span>(err4&lt;minErr &amp;&amp; t1.ptr&lt;<span class="keywordtype">double</span>&gt;(0)[0]&lt;0)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        idx=4;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        secondErr=minErr;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        minErr=err4;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="comment">/*if(secondErr==minErr)</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">      {</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">        R=this-&gt;R;</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">        t=this-&gt;T;</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">        return;      </span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">      }*/</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">if</span>(idx==1) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            R=R1;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            t=t1;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;       }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">if</span>(idx==2) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            R=R2;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            t=t2;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;       }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">if</span>(idx==3) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            R=R1;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            t=t2;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;       }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">if</span>(idx==4) {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            R=R2;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            t=t1;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;       }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a3c8ef84424fa111c63437a3db8f04333"><div class="ttname"><a href="classStereoCamera.html#a3c8ef84424fa111c63437a3db8f04333">StereoCamera::triangulation</a></div><div class="ttdeci">Point3f triangulation(Point2f &amp;point1, Point2f &amp;point2)</div><div class="ttdoc">It performs the triangulation using the stored in the internal P1 and P2 3x4 Camera Matrices...</div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l00681">stereoCamera.cpp:681</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79e986f2970bb2c5b5acd1ede65984aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::computeDisparity </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>best</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>uniquenessRatio</em> = <code>15</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>speckleWindowSize</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>speckleRange</em> = <code>16</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfDisparities</em> = <code>64</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>SADWindowSize</em> = <code>7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>minDisparity</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>preFilterCap</em> = <code>63</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>disp12MaxDiff</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It computes the Disparity Map using H. </p>
<p>Hirschmuller Algorithm (CVPR 2006) (see stereoDisparity). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">best</td><td>set equal true for better accuracy, equal false for save computation. </td></tr>
    <tr><td class="paramname">uniquenessRatio</td><td>The margin in percents by which the best (minimum) computed cost function value should win the second best value to consider the found match correct. Normally, some value within 5-15 range is good enough. </td></tr>
    <tr><td class="paramname">speckleWindowSize</td><td>Maximum size of smooth disparity regions to consider them noise speckles and invdalidate. Set it to 0 to disable speckle filtering. Otherwise, set it somewhere in 50-200 range. </td></tr>
    <tr><td class="paramname">speckleRange</td><td>Maximum disparity variation within each connected component. If you do speckle filtering, set it to some positive value, multiple of 16. Normally, 16 or 32 is good enough. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Run the calibration or set all the parameters before using this method. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00421">421</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (this-&gt;Kleft.empty() || this-&gt;DistL.empty() || this-&gt;Kright.empty() || this-&gt;DistR.empty())</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        cout &lt;&lt;<span class="stringliteral">&quot; Cameras are not calibrated! Run the Calibration first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (this-&gt;imleft.empty() || this-&gt;imright.empty())</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Images are not set! set the images first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    Size img_size=this-&gt;imleft.size();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    StereoSGBM sgbm;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (cameraChanged)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        mutex-&gt;wait();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        stereoRectify(this-&gt;Kleft, this-&gt;DistL, this-&gt;Kright, this-&gt;DistR, img_size,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                      this-&gt;R, this-&gt;T, this-&gt;RLrect, this-&gt;RRrect, this-&gt;PLrect,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                      this-&gt;PRrect, this-&gt;Q, -1);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> (!rectify)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            this-&gt;RLrect=Mat::eye(3,3,CV_32FC1);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            this-&gt;RRrect=Mat::eye(3,3,CV_32FC1);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            this-&gt;PLrect=this-&gt;Kleft;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            this-&gt;PRrect=this-&gt;Kright;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (cameraChanged)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        initUndistortRectifyMap(this-&gt;Kleft, this-&gt;DistL, this-&gt;RLrect, this-&gt;PLrect,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                img_size, CV_32FC1, this-&gt;map11, this-&gt;map12);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        initUndistortRectifyMap(this-&gt;Kright,  this-&gt;DistR, this-&gt;RRrect, this-&gt;PRrect,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                img_size, CV_32FC1, this-&gt;map21, this-&gt;map22);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    Mat img1r, img2r;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    remap(this-&gt;imleft, img1r, this-&gt;map11, this-&gt;map12, cv::INTER_LINEAR);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    remap(this-&gt;imright, img2r, this-&gt;map21,this-&gt;map22, cv::INTER_LINEAR);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    sgbm.preFilterCap=preFilterCap; <span class="comment">//63</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    sgbm.SADWindowSize=SADWindowSize;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">int</span> cn=this-&gt;imleft.channels();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    sgbm.P1=8*cn*sgbm.SADWindowSize*sgbm.SADWindowSize;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    sgbm.P2=32*cn*sgbm.SADWindowSize*sgbm.SADWindowSize;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    sgbm.minDisparity=minDisparity; <span class="comment">//-15</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    sgbm.numberOfDisparities=numberOfDisparities;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    sgbm.uniquenessRatio=uniquenessRatio; <span class="comment">//22</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    sgbm.speckleWindowSize=speckleWindowSize; <span class="comment">//100</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    sgbm.speckleRange=speckleRange; <span class="comment">//32</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    sgbm.disp12MaxDiff=disp12MaxDiff;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    sgbm.fullDP=best; <span class="comment">// alg == STEREO_HH</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    Mat disp,disp8,map,dispTemp;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    sgbm(img1r,img2r,disp);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    disp.convertTo(map, CV_32FC1, 1.0,0.0);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    map.convertTo(map,CV_32FC1,255/(numberOfDisparities*16.));</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">//normalize(map,map, 0, 255, cv::NORM_MINMAX, CV_8UC1);</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (cameraChanged)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        this-&gt;mutex-&gt;wait();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        Mat inverseMapL(map.rows*map.cols,1,CV_32FC2);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        Mat inverseMapR(map.rows*map.cols,1,CV_32FC2);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;map.rows; y++)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;map.cols; x++)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                inverseMapL.ptr&lt;<span class="keywordtype">float</span>&gt;(y*map.cols+x)[0]=(<span class="keywordtype">float</span>)x;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                inverseMapL.ptr&lt;<span class="keywordtype">float</span>&gt;(y*map.cols+x)[1]=(<span class="keywordtype">float</span>)y;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                inverseMapR.ptr&lt;<span class="keywordtype">float</span>&gt;(y*map.cols+x)[0]=(<span class="keywordtype">float</span>)x;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                inverseMapR.ptr&lt;<span class="keywordtype">float</span>&gt;(y*map.cols+x)[1]=(<span class="keywordtype">float</span>)y;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        undistortPoints(inverseMapL,inverseMapL,this-&gt;Kleft,this-&gt;DistL,this-&gt;RLrect,this-&gt;PLrect);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        undistortPoints(inverseMapR,inverseMapR,this-&gt;Kright,this-&gt;DistR,this-&gt;RRrect,this-&gt;PRrect);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        Mat mapperL=inverseMapL.reshape(2,map.rows);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        Mat mapperR=inverseMapR.reshape(2,map.rows);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        this-&gt;MapperL=mapperL;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        this-&gt;MapperR=mapperR;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        this-&gt;mutex-&gt;post();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        cameraChanged=false;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    Mat x;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    remap(map,dispTemp,this-&gt;MapperL,x,cv::INTER_LINEAR);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    dispTemp.convertTo(disp8,CV_8U); </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    this-&gt;mutex-&gt;wait();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    this-&gt;Disparity=disp8;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    this-&gt;Disparity16=disp;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    this-&gt;mutex-&gt;post();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52ef2f3401488e5c4fa6badd1336f96d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::computeWorldImage </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>H</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The method returns a 3-Channels float image with the world coordinates w.r.t H reference system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">H</td><td>the transformation from the camera reference system to the H reference system </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The 3-Channels float image with the world coordinates w.r.t H reference system. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02173">2173</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l01829">getRLrect()</a>.</p>
<div class="fragment"><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;{</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    Mat worldImg(Disparity16.rows,Disparity16.cols,CV_32FC3);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordflow">if</span>(H.empty())</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        H=H.eye(4,4,CV_64FC1);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">if</span>(Disparity16.empty() || MapperL.empty() || Q.empty())</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    {</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        cout &lt;&lt;<span class="stringliteral">&quot; Run computeDisparity() method first&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="keywordflow">return</span> worldImg;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    }</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    Mat dispTemp;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    Mat x;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    remap(this-&gt;Disparity16,dispTemp,this-&gt;MapperL,x,cv::INTER_LINEAR);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    reprojectImageTo3D(dispTemp, worldImg,this-&gt;Q,<span class="keyword">true</span>);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;worldImg.rows; i++)</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    {</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;worldImg.cols; j++)</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        {   </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            Mat RLrectTmp=this-&gt;<a class="code" href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">getRLrect</a>().t();</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            Mat Tfake = Mat::zeros(0,3,CV_64F);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            Mat P(4,1,CV_64FC1);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            <span class="keywordflow">if</span>((worldImg.data + worldImg.step * i)[j * worldImg.channels() + 2]&gt;100)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=0.0;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=0.0;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=0.0;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(3,0)=1.0;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=(worldImg.data + worldImg.step * i)[j * worldImg.channels() + 0];</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=(worldImg.data + worldImg.step * i)[j * worldImg.channels() + 1];</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=(worldImg.data + worldImg.step * i)[j * worldImg.channels() + 2];</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                P.at&lt;<span class="keywordtype">double</span>&gt;(3,0)=1;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                Mat Hrect=buildRotTras(RLrectTmp,Tfake);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                P=H*Hrect*P;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            (worldImg.data + worldImg.step * i)[j * worldImg.channels() + 0]=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            (worldImg.data + worldImg.step * i)[j * worldImg.channels() + 1]=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            (worldImg.data + worldImg.step * i)[j * worldImg.channels() + 2]=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">return</span> worldImg;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a986686c56d4bf5381ea57b3f49338af1"><div class="ttname"><a href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">StereoCamera::getRLrect</a></div><div class="ttdeci">const Mat getRLrect()</div><div class="ttdoc">It returns the rotation matrix between the original left camera and the rectified left camera...</div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01829">stereoCamera.cpp:1829</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6580ff03c7cec5c385ec717f9c018e21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::drawMatches </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The method returns a 3-Channels 8bit image with the image matches. </p>
<dl class="section return"><dt>Returns</dt><dd>The 3-Channels 8bit image with the image matches. Call <a class="el" href="classStereoCamera.html#a64e9e3dbbc6db7e7eb18fa0d9d84f7a6" title="It finds matches between two images. ">findMatch()</a> to retrieve the keypoints first. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01596">1596</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;{</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">if</span>(this-&gt;imleftund.empty() || this-&gt;imrightund.empty()) {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;              imleftund=imleft;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;              imrightund=imright;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    Mat matchImg;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    vector&lt;KeyPoint&gt; keypoints1(InliersL.size());</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    vector&lt;KeyPoint&gt; keypoints2(InliersL.size());</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    vector&lt;DMatch&gt; filteredMatches(InliersL.size());</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;InliersL.size(); i++)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        filteredMatches[i].queryIdx=i;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        filteredMatches[i].trainIdx=i;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        keypoints1[i]=cv::KeyPoint(InliersL[i],2);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        keypoints2[i]=cv::KeyPoint(InliersR[i],2);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    cv::drawMatches(this-&gt;imleftund, keypoints1, this-&gt;imrightund, keypoints2,filteredMatches,matchImg,Scalar(0,0,255,0), Scalar(0,0,255,0));</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">return</span> matchImg;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a180388e93b654802c7c56c18d206214b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StereoCamera::essentialDecomposition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It decomposes the essential matrix in Rotation and Translation between the two views. </p>
<p>The output is stored in the private members R and T. </p>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00903">903</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l01044">chierality()</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                          {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span>(E.empty() ) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Essential Matrix is Empy! Run the estimateEssential first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span>(this-&gt;InliersL.empty()) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;No matches in memory! Run findMatch first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    Mat W=Mat(3,3,CV_64FC1);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    W.setTo(0);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=0;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(0,1)=-1;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(0,2)=0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=1;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(1,1)=0;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(1,2)=0;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=0;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(2,1)=0;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    W.at&lt;<span class="keywordtype">double</span>&gt;(2,2)=1;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    SVD dec(E);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    Mat Y=Mat::eye(3,3,CV_64FC1);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    Y.at&lt;<span class="keywordtype">double</span>&gt;(2,2)=0.0;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    E=dec.u*Y*dec.vt; <span class="comment">// projection to the Essential Matrix space</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    dec(E);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    Mat V=dec.vt;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    Mat U=dec.u;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    Mat R1=U*W*V;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    Mat R2=U*W.t()*V;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">if</span>(determinant(R1)&lt;0 || determinant(R2)&lt;0) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        E=-E;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        SVD dec2(E);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        V=dec2.vt;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        U=dec2.u;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        R1=U*W*V;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        R2=U*W.t()*V;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    Mat t1=U(Range(0,3),Range(2,3));</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    Mat t2=-t1;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    Mat Rnew=Mat(3,3,CV_64FC1);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    Rnew.setTo(0);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    Mat tnew=Mat(3,1,CV_64FC1);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="classStereoCamera.html#a245346dbef63e13807c5cd9160803d25">chierality</a>(R1,R2,t1,t2,Rnew,tnew,this-&gt;InliersL,this-&gt;InliersR);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">double</span> t_norm=norm(T/norm(T),tnew/norm(tnew));</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordtype">double</span> r_norm=norm(R,Rnew);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    Mat rvec_new=Mat::zeros(3,1,CV_64FC1);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    Mat rvec_exp=Mat::zeros(3,1,CV_64FC1);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    Rodrigues(Rnew,rvec_new);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    Rodrigues(R_exp,rvec_exp);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    Mat t_est=(tnew/norm(tnew))*norm(this-&gt;T);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    Mat diff_angles=rvec_exp-rvec_new;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    Mat diff_tran=T_exp-t_est;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">/*fprintf(stdout, &quot;Estimated Translation \n &quot;);</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">    printMatrix(t_est);</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">    fprintf(stdout, &quot;\n &quot;);*/</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Angles Differences: %f %f %f \n&quot;</span>, diff_angles.at&lt;<span class="keywordtype">double</span>&gt;(0,0),diff_angles.at&lt;<span class="keywordtype">double</span>&gt;(1,0),diff_angles.at&lt;<span class="keywordtype">double</span>&gt;(2,0));</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;Translation Differences: %f %f %f \n&quot;</span>, diff_tran.at&lt;<span class="keywordtype">double</span>&gt;(0,0),diff_tran.at&lt;<span class="keywordtype">double</span>&gt;(1,0),diff_tran.at&lt;<span class="keywordtype">double</span>&gt;(2,0));    </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// Magic numbers: rvec_new are the rotation angles, only vergence (rvec_new(1,0)) is allowed to be large</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// t_est is the translation estimated, it can change a little bit when joint 4 of the head is moving</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">//if(norm(tnew) &gt;0 &amp;&amp; norm(Rnew)&gt;0 &amp;&amp; abs(rvec_new.at&lt;double&gt;(0,0))&lt;0.05 &amp;&amp; abs(rvec_new.at&lt;double&gt;(2,0))&lt;0.05 &amp;&amp; abs(rvec_new.at&lt;double&gt;(1,0))&lt;0.5 &amp;&amp; abs(t_est.at&lt;double&gt;(0,0)) &lt;0.069 &amp;&amp; abs(t_est.at&lt;double&gt;(0,0))&gt;0.066 &amp;&amp; abs(t_est.at&lt;double&gt;(1,0))&lt;0.01 &amp;&amp; abs(t_est.at&lt;double&gt;(2,0))&lt; 0.02)</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">if</span>(abs(diff_angles.at&lt;<span class="keywordtype">double</span>&gt;(0,0))&lt;0.1 &amp;&amp; abs(diff_angles.at&lt;<span class="keywordtype">double</span>&gt;(1,0))&lt;0.15 &amp;&amp; abs(diff_angles.at&lt;<span class="keywordtype">double</span>&gt;(2,0))&lt;0.1 &amp;&amp; abs(diff_tran.at&lt;<span class="keywordtype">double</span>&gt;(0,0))&lt;0.005&amp;&amp; abs(diff_tran.at&lt;<span class="keywordtype">double</span>&gt;(1,0))&lt;0.005 &amp;&amp; abs(diff_tran.at&lt;<span class="keywordtype">double</span>&gt;(2,0))&lt;0.005)    </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        this-&gt;mutex-&gt;wait();</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        this-&gt;R=Rnew;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        this-&gt;T=(tnew/norm(tnew))*norm(this-&gt;T);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        this-&gt;updatePMatrix();</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        this-&gt;cameraChanged=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        this-&gt;mutex-&gt;post();</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="comment">//printMatrix(R);</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="comment">//printMatrix(T);        </span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;determinant is &quot; &lt;&lt; determinant(Rnew) &lt;&lt; endl;; </span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;WINNERS: &quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">//printMatrix(R2);</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">/*Mat Tx=Mat(3,3,CV_64FC1);</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">    Tx.setTo(0);</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">    Tx.at&lt;double&gt;(0,1)=-tnew.at&lt;double&gt;(2,0);</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">    Tx.at&lt;double&gt;(0,2)=tnew.at&lt;double&gt;(1,0);</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">    Tx.at&lt;double&gt;(1,0)=tnew.at&lt;double&gt;(2,0);</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">    Tx.at&lt;double&gt;(1,2)=-tnew.at&lt;double&gt;(0,0);</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">    Tx.at&lt;double&gt;(2,0)=-tnew.at&lt;double&gt;(1,0);</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">    Tx.at&lt;double&gt;(2,1)=tnew.at&lt;double&gt;(0,0);</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">    Mat Erec=Tx*Rnew;</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">    fprintf(stdout,&quot;estimated \n&quot;);</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">    printMatrix(Erec);</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">           </span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">    fprintf(stdout,&quot;true \n&quot;);</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">    printMatrix(E); */</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">//printMatrix(t1);</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">//printMatrix(t2);    </span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;Det: &quot; &lt;&lt; determinant(R) &lt;&lt; endl;; </span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a245346dbef63e13807c5cd9160803d25"><div class="ttname"><a href="classStereoCamera.html#a245346dbef63e13807c5cd9160803d25">StereoCamera::chierality</a></div><div class="ttdeci">void chierality(Mat &amp;R1, Mat &amp;R2, Mat &amp;t1, Mat &amp;t2, Mat &amp;R, Mat &amp;t, Vector&lt; Point2f &gt; points1, Vector&lt; Point2f &gt; points2)</div><div class="ttdoc">It performs the chierality test: given a couple of rotation matrices, translation vectors and matches...</div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01044">stereoCamera.cpp:1044</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab2eded08bca185ac22cd6343cb4c85c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::estimateEssential </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It estimates the essential matrix (3x3) E between two views. </p>
<p>The output is stored in the private member E. </p>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00791">791</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l00709">FfromP()</a>.</p>
<div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                     {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    this-&gt;InliersL.clear();</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    this-&gt;InliersR.clear();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span>(this-&gt;PointsL.size()&lt;10 || this-&gt;PointsL.size()&lt;10 ) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Not enough matches in memory! Run findMatch first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        this-&gt;E=Mat(3,3,CV_64FC1);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    updateExpectedCameraMatrices();</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    Mat F_exp=<a class="code" href="classStereoCamera.html#a3fe4e87322f8644cd21ce06e8522c815">FfromP</a>(Pleft_exp,Pright_exp);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    vector&lt;Point2f&gt; filteredL;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    vector&lt;Point2f&gt; filteredR;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    fprintf(stdout,<span class="stringliteral">&quot;%lu Match Found \n&quot;</span>,PointsR.size());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    Mat pl=Mat(3,1,CV_64FC1);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    Mat pr=Mat(3,1,CV_64FC1);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int) PointsL.size(); i++) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        pl.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=PointsL[i].x;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        pl.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=PointsL[i].y;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        pl.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=1;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        pr.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=PointsR[i].x;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        pr.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=PointsR[i].y;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        pr.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=1;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;             </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        Mat xrFxl=pr.t()*F_exp*pl;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        Mat Fxl=F_exp*pl;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        Mat Fxr=F_exp.t()*pr;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        pow(xrFxl,2,xrFxl);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        pow(Fxl,2,Fxl);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        pow(Fxr,2,Fxr);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        Scalar den1,den2;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        den1=sum(Fxl);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        den2=sum(Fxr);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordtype">double</span> sampsonDistance=xrFxl.at&lt;<span class="keywordtype">double</span>&gt;(0,0)/(den1.val[0]+den2.val[0]);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">if</span>(sampsonDistance&lt;0.1) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            filteredL.push_back(PointsL[i]);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            filteredR.push_back(PointsR[i]);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    fprintf(stdout,<span class="stringliteral">&quot;%lu Match After Kinematics Filtering \n&quot;</span>,filteredL.size());</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    vector&lt;uchar&gt; status;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    this-&gt;F=findFundamentalMat(Mat(filteredL), Mat(filteredR),status, CV_FM_8POINT, 1, 0.999);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int) filteredL.size(); i++) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        pl.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=filteredL[i].x;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        pl.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=filteredL[i].y;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        pl.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=1;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        pr.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=filteredR[i].x;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        pr.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=filteredR[i].y;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        pr.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=1;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;             </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        Mat xrFxl=pr.t()*F*pl;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        Mat Fxl=F*pl;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        Mat Fxr=F.t()*pr;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        pow(xrFxl,2,xrFxl);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        pow(Fxl,2,Fxl);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        pow(Fxr,2,Fxr);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        Scalar den1,den2;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        den1=sum(Fxl);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        den2=sum(Fxr);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordtype">double</span> sampsonDistance=xrFxl.at&lt;<span class="keywordtype">double</span>&gt;(0,0)/(den1.val[0]+den2.val[0]);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">if</span>(status[i]==1 &amp;&amp; xrFxl.at&lt;<span class="keywordtype">double</span>&gt;(0,0)&lt;0.001) </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            InliersL.push_back(filteredL[i]);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            InliersR.push_back(filteredR[i]);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    fprintf(stdout,<span class="stringliteral">&quot;%lu Match After RANSAC Filtering \n&quot;</span>,InliersL.size());</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span>(this-&gt;InliersL.size()&lt;10 || this-&gt;InliersR.size()&lt;10 ) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        InliersL.clear();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        InliersR.clear();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Not enough matches in memory! Run findMatch first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        this-&gt;E=Mat(3,3,CV_64FC1);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }    </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    this-&gt;F=findFundamentalMat(Mat(InliersL), Mat(InliersR),status, CV_FM_8POINT, 1, 0.999);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">//    cout &lt;&lt; &quot;Matches: &quot; &lt;&lt; PointsL.size() &lt;&lt; &quot; Inliers: &quot; &lt;&lt; InliersL.size() &lt;&lt; endl;</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    this-&gt;E=this-&gt;Kright.t()*this-&gt;F*this-&gt;Kleft;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a3fe4e87322f8644cd21ce06e8522c815"><div class="ttname"><a href="classStereoCamera.html#a3fe4e87322f8644cd21ce06e8522c815">StereoCamera::FfromP</a></div><div class="ttdeci">Mat FfromP(Mat &amp;P1, Mat &amp;P2)</div><div class="ttdoc">The function computes the fundamental matrix starting from known camera matrices. ...</div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l00709">stereoCamera.cpp:709</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3fe4e87322f8644cd21ce06e8522c815"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::FfromP </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>P1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>P2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function computes the fundamental matrix starting from known camera matrices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P1</td><td>a 3x4 matrix representing the camera matrix of the left view. </td></tr>
    <tr><td class="paramname">P2</td><td>a 3x4 matrix representing the camera matrix of the right view. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a 3x3 matrix representing the fundamental matrix. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00709">709</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l00791">estimateEssential()</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    Mat F_true(3,3,CV_64FC1);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    Mat X1(2,4,CV_64FC1);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    Mat X2(2,4,CV_64FC1);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    Mat X3(2,4,CV_64FC1);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    Mat Y1(2,4,CV_64FC1);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    Mat Y2(2,4,CV_64FC1);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    Mat Y3(2,4,CV_64FC1);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;P1.rows; i++)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;P1.cols; j++)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">if</span>(i==0)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                X2.at&lt;<span class="keywordtype">double</span>&gt;(1,j)= P1.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                X3.at&lt;<span class="keywordtype">double</span>&gt;(0,j)= P1.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                Y2.at&lt;<span class="keywordtype">double</span>&gt;(1,j)= P2.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                Y3.at&lt;<span class="keywordtype">double</span>&gt;(0,j)= P2.at&lt;<span class="keywordtype">double</span>&gt;(i,j);                    </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">if</span>(i==1)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                X1.at&lt;<span class="keywordtype">double</span>&gt;(0,j)= P1.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                X3.at&lt;<span class="keywordtype">double</span>&gt;(1,j)= P1.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                Y1.at&lt;<span class="keywordtype">double</span>&gt;(0,j)= P2.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                Y3.at&lt;<span class="keywordtype">double</span>&gt;(1,j)= P2.at&lt;<span class="keywordtype">double</span>&gt;(i,j);                   </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">if</span>(i==2)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                X1.at&lt;<span class="keywordtype">double</span>&gt;(1,j)= P1.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                X2.at&lt;<span class="keywordtype">double</span>&gt;(0,j)= P1.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                Y1.at&lt;<span class="keywordtype">double</span>&gt;(1,j)= P2.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                Y2.at&lt;<span class="keywordtype">double</span>&gt;(0,j)= P2.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    std::vector&lt;Mat&gt; MatX;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    std::vector&lt;Mat&gt; MatY;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    MatX.push_back(X1);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    MatX.push_back(X2);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    MatX.push_back(X3);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    MatY.push_back(Y1);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    MatY.push_back(Y2);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    MatY.push_back(Y3);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;F_true.rows; i++)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;F_true.cols; j++)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            Mat X=MatX[i];</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            Mat Y=MatY[j];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            Mat concatenated;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            cv::vconcat(X,Y,concatenated);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            F_true.at&lt;<span class="keywordtype">double</span>&gt;(j,i)=cv::determinant(concatenated);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">return</span> F_true;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a64e9e3dbbc6db7e7eb18fa0d9d84f7a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::findMatch </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>visualize</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>displacement</em> = <code>15</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em> = <code>0.25</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It finds matches between two images. </p>
<p>SIFT detector and descriptor is used. </p><dl class="section note"><dt>Note</dt><dd>Run setImages and indistortImages methods before using this method. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visualize</td><td>true if you want to visualize matches between images </td></tr>
    <tr><td class="paramname">displacement</td><td>maximum pixel displacement between first and second camera </td></tr>
    <tr><td class="paramname">radius</td><td>maximum radius between the first candidate match and the second one </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00556">556</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                                                              {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span>(this-&gt;imleftund.empty() || this-&gt;imrightund.empty()) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;              imleftund=imleft;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;              imrightund=imright;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    this-&gt;PointsL.clear();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    this-&gt;PointsR.clear();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    this-&gt;InliersL.clear();</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    this-&gt;InliersR.clear();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">    #ifdef USE_NEWFEATURES</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        cv::SiftFeatureDetector  detector;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        cv::SiftDescriptorExtractor descriptorExtractor;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        cv::BFMatcher descriptorMatcher;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        Mat gray(imleft.rows,imleft.cols, CV_8UC1);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        imleftund.convertTo(gray,CV_8UC1);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        vector&lt;KeyPoint&gt; keypoints1;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        detector.detect( gray, keypoints1 );</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        Mat descriptors1;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        descriptorExtractor.compute(this-&gt;imleftund, keypoints1, descriptors1 );</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        vector&lt;KeyPoint&gt; keypoints2;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        detector.detect( this-&gt;imrightund, keypoints2 );</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        Mat descriptors2;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        descriptorExtractor.compute( this-&gt;imrightund, keypoints2, descriptors2 );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        vector&lt;DMatch&gt; filteredMatches;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        crossCheckMatching( descriptorMatcher, descriptors1, descriptors2, filteredMatches,radius, 1 );</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        Ptr&lt;FeatureDetector&gt; detector = FeatureDetector::create( <span class="stringliteral">&quot;SIFT&quot;</span> );</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        Ptr&lt;DescriptorExtractor&gt; descriptorExtractor = DescriptorExtractor::create(<span class="stringliteral">&quot;SIFT&quot;</span>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        Ptr&lt;DescriptorMatcher&gt; descriptorMatcher = DescriptorMatcher::create(<span class="stringliteral">&quot;BruteForce&quot;</span> );</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        Mat gray(imleft.rows,imleft.cols, CV_8UC1);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        imleftund.convertTo(gray,CV_8UC1);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        vector&lt;KeyPoint&gt; keypoints1;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        detector-&gt;detect( gray, keypoints1 );</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        Mat descriptors1;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        descriptorExtractor-&gt;compute(this-&gt;imleftund, keypoints1, descriptors1 );</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        vector&lt;KeyPoint&gt; keypoints2;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        detector-&gt;detect( this-&gt;imrightund, keypoints2 );</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        Mat descriptors2;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        descriptorExtractor-&gt;compute( this-&gt;imrightund, keypoints2, descriptors2 );</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        vector&lt;DMatch&gt; filteredMatches;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    vector&lt;char&gt; matchMask(filteredMatches.size(),1);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int)filteredMatches.size(); i++) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        Point2f pointL=keypoints1[filteredMatches[i].queryIdx].pt;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        Point2f pointR=keypoints2[filteredMatches[i].trainIdx].pt;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span>(abs(pointL.y-pointR.y)&lt;displacement) { <span class="comment">//10 320x240 20 640x480</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="comment">//if((pointL.x-pointR.x)&gt;0) // disparity always positive</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="comment">//{</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                this-&gt;PointsR.push_back(pointR);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                this-&gt;PointsL.push_back(pointL);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="comment">//}</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="comment">//else</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="comment">//    matchMask[i]=0;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            matchMask[i]=0;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;6 \n&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <span class="comment">// draw Matches</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    Mat matchImg;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span>(visualize) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        cv::drawMatches(this-&gt;imleftund, keypoints1, this-&gt;imrightund, keypoints2,filteredMatches,matchImg,Scalar(0,0,255,0), Scalar(0,0,255,0),matchMask);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    fprintf(stdout, <span class="stringliteral">&quot;7 \n&quot;</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">return</span> matchImg;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d8fde0cbd4604085b883f22cc606c01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point2f StereoCamera::fromRectifiedToOriginal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>camera</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the u,v pixel coordinates in the rectified image the method returns the position of the pixel in the non-rectified frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>the x pixel coordinate in the rectified image. </td></tr>
    <tr><td class="paramname">v</td><td>the y pixel coordinate in the rectified image. </td></tr>
    <tr><td class="paramname">cam</td><td>cam=1 for left image, cam=2 for right image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the pixel position in the non-rectified image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00529">529</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;{</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    cv::Point2f originalPoint;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span>(u&gt;=map11.rows || u&lt;0 || v&gt;=map12.cols || v&lt; 0)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        originalPoint.x=0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        originalPoint.y=0;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">return</span> originalPoint;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">if</span>(camera==LEFT)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            originalPoint.x=map11.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[u];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            originalPoint.y=map12.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[u];</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            originalPoint.x=map21.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[u];</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            originalPoint.y=map22.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[u];</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">return</span> originalPoint;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97607922d84e1a1a006cd7a5aec93a24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getDisparity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the disparity image. </p>
<dl class="section return"><dt>Returns</dt><dd>the disparity image computed via <a class="el" href="classStereoCamera.html#a79e986f2970bb2c5b5acd1ede65984aa" title="It computes the Disparity Map using H. ">computeDisparity()</a>. The image is 8 bit unsigned. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00376">376</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                     {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> this-&gt;Disparity;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a89f9890f50d85be9ebda7a0769279348"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getDisparity16 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the disparity image. </p>
<dl class="section return"><dt>Returns</dt><dd>the disparity image computed via <a class="el" href="classStereoCamera.html#a79e986f2970bb2c5b5acd1ede65984aa" title="It computes the Disparity Map using H. ">computeDisparity()</a>. The image is 16 bit signed. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00380">380</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l01875">metricTriangulation()</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                       {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> this-&gt;Disparity16;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4830201154ab288bd93f6cceb2c2daf5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::getDistCoeffLeft </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the 5x1 left distortion coefficients. </p>
<dl class="section return"><dt>Returns</dt><dd>5x1 left distortion coefficients. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02225">2225</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;{</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">return</span> this-&gt;DistL;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3edeb24b68ee4266f89982533ad1e9bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::getDistCoeffRight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the 5x1 right distortion coefficients. </p>
<dl class="section return"><dt>Returns</dt><dd>5x1 right distortion coefficients. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02230">2230</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;{</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">return</span> this-&gt;DistR;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af64550bb8a7a665930dee5eea87b7e47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point2f StereoCamera::getDistortedPixel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cam</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the u,v pixel coordinates in the undistorted image the method returns the original position of the pixel in the distorted frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>the x pixel coordinate in the undistorted image. </td></tr>
    <tr><td class="paramname">v</td><td>the y pixel coordinate in the undistorted image. </td></tr>
    <tr><td class="paramname">cam</td><td>cam=1 for left image, cam=2 for right image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the pixel position in the distorted image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02244">2244</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;{</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    Point2f distortedPixel;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    Mat MapperX,MapperY;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">if</span>(cam==LEFT)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        MapperX=mapxL;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        MapperY=mapyL;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        MapperX=mapxR;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        MapperY=mapyR;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    distortedPixel.x=MapperX.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[u];</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    distortedPixel.y=MapperY.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[u];</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">return</span> distortedPixel;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a257d9f531c444b685a0b96ae3908c2d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getFundamental </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the 3x3 fundamental matrix. </p>
<dl class="section return"><dt>Returns</dt><dd>3x3 fundamental matrix. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01396">1396</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                       {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">return</span> this-&gt;F;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57d155d519c621a7a580f41ec114df01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getImLeft </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the left (first) image. </p>
<dl class="section return"><dt>Returns</dt><dd>the left (first) image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00367">367</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                  {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> this-&gt;imleft;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48ff47fc8326d511677bef8bcf3a65bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getImLeftUnd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the left undistorted image. </p>
<dl class="section return"><dt>Returns</dt><dd>the left undistorted image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01392">1392</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                     {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">return</span> this-&gt;imleftund;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a09e72c3430250883aac6ab5a4d98961f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getImRight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the right (second) image. </p>
<dl class="section return"><dt>Returns</dt><dd>the right (second) image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00372">372</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                   {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> this-&gt;imright;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0485caf9bd52a7317776e5db495446a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getImRightUnd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the right undistorted image. </p>
<dl class="section return"><dt>Returns</dt><dd>the right undistorted image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01400">1400</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                                      {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">return</span> this-&gt;imrightund;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8533ec543166868e3db471bad0cb61a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getKleft </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the 3x3 left camera matrix. </p>
<dl class="section return"><dt>Returns</dt><dd>3x3 left camera matrix. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00039">39</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                 {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">return</span> this-&gt;Kleft;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a62ea986b40a785e589704bb58750e15b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getKright </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the 3x3 right camera matrix. </p>
<dl class="section return"><dt>Returns</dt><dd>3x3 right camera matrix. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00042">42</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                  {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">return</span> this-&gt;Kright;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0bd4492f7f87862955da0bc5d0042cc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::getLRectified </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The method returns the first rectified image. </p>
<dl class="section return"><dt>Returns</dt><dd>The first rectified image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02103">2103</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;{</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">return</span> this-&gt;imgLeftRect;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6d7a3361adfda3a05eea2d5116ed2515"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getMapperL </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the mapping between the original left camera and the rectified left camera. </p>
<dl class="section return"><dt>Returns</dt><dd>a 16 bit signed 2 channel image containing the mapping from the original left camera to the rectified left camera. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01837">1837</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l01875">metricTriangulation()</a>.</p>
<div class="fragment"><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                                   {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keywordflow">return</span> this-&gt;MapperL;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8cbd829aba62360200035bb452edc42b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getMapperR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the mapping between the original right camera and the rectified right camera. </p>
<dl class="section return"><dt>Returns</dt><dd>a 16 bit signed 2 channel image containing the mapping from the original right camera to the rectified right camera. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01841">1841</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                   {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordflow">return</span> this-&gt;MapperR;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac42cf4193f379a3c0ecf5e40c61358f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const vector&lt; Point2f &gt; StereoCamera::getMatchLeft </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the pixel coordinates of the matches in the left image. </p>
<dl class="section return"><dt>Returns</dt><dd>pixel coordinates of the matches in the left image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00046">46</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                                 {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">return</span> this-&gt;InliersL;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab35a9b702cd5213bd8d4de8491399201"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const vector&lt; Point2f &gt; StereoCamera::getMatchRight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the pixel coordinates of the matches in the right image. </p>
<dl class="section return"><dt>Returns</dt><dd>pixel coordinates of the matches in the right image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00049">49</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                   {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> this-&gt;InliersR;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a43bd5710058d9ee0ed94dc8b74e5656c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getQ </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the 4x4 disparity-to-depth mapping matrix. </p>
<dl class="section return"><dt>Returns</dt><dd>4x4 disparity-to-depth mapping matrix. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00383">383</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                             {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span> this-&gt;Q;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a986686c56d4bf5381ea57b3f49338af1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getRLrect </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the rotation matrix between the original left camera and the rectified left camera. </p>
<dl class="section return"><dt>Returns</dt><dd>3x3 rotation matrix between the original left camera and the rectified left camera. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01829">1829</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l02173">computeWorldImage()</a>, <a class="el" href="stereoCamera_8cpp_source.html#l01962">metricTriangulation()</a>, and <a class="el" href="stereoCamera_8cpp_source.html#l02054">triangulateKnownDisparity()</a>.</p>
<div class="fragment"><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                                  {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">return</span> this-&gt;RLrect;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13fc8d5d205e09ab3d1bb8010829b0c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getRotation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the rotation matrix between the two cameras. </p>
<dl class="section return"><dt>Returns</dt><dd>3x3 rotation matrix between the first and the second camera. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01490">1490</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l01624">horn()</a>.</p>
<div class="fragment"><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                                    {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">return</span> this-&gt;R;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf4ba8eaa338ff24db1196849a96e5e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mat StereoCamera::getRRectified </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The method returns the second rectified image. </p>
<dl class="section return"><dt>Returns</dt><dd>The second rectified image. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02108">2108</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;{</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keywordflow">return</span> this-&gt;imgRightRect;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a08979926b86d513f1b373109f5a4733d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getRRrect </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the rotation matrix between the original right camera and the rectified right camera. </p>
<dl class="section return"><dt>Returns</dt><dd>3x3 rotation matrix between the original right camera and the rectified right camera. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01833">1833</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                                  {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">return</span> this-&gt;RRrect;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c7df54191a3c73486c0136de18dd52e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Mat StereoCamera::getTranslation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It returns the translation vector between the two cameras. </p>
<dl class="section return"><dt>Returns</dt><dd>3x1 translation matrix between the first and the second camera. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01486">1486</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                       {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">return</span> this-&gt;T;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adf155975709fdbf09d3133899d074a02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::horn </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>K1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>K2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Point2f &gt; &amp;&#160;</td>
          <td class="paramname"><em>Points1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Point2f &gt; &amp;&#160;</td>
          <td class="paramname"><em>Points2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Tras</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the horn relative orientations algorithm i.e. </p>
<p>it estimates the motion from one camera to another one using a initial guess. A good initial guess can be obtained using the essentialDecomposition method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">K1</td><td>3x3 matrix with intrinsic parameters of the first camera </td></tr>
    <tr><td class="paramname">K2</td><td>3x3 matrix with intrinsic parameters of the second camera </td></tr>
    <tr><td class="paramname">Points1</td><td>matches in the first image </td></tr>
    <tr><td class="paramname">Points2</td><td>matches in the second image </td></tr>
    <tr><td class="paramname">Rot</td><td>initial rotation (3x3 matrix) guess. The new output rotation is stored here </td></tr>
    <tr><td class="paramname">Tras</td><td>initial translation (3x1 matrix) guess. The new output translation is stored here </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01624">1624</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l01490">getRotation()</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l01563">hornRelativeOrientations()</a>.</p>
<div class="fragment"><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                                                                                                   {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordtype">double</span> prevres = 1E40;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordtype">double</span> res = 1E39;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordtype">double</span> vanishing = 1E-16;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    Tras=Tras/norm(Tras);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    normalizePoints(K1,K2,PointsL,PointsR);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">int</span> iters=0;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    Mat B(3,3,CV_64FC1);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    Mat C(3,3,CV_64FC1);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    Mat D(3,3,CV_64FC1);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    Mat cs(3,1,CV_64FC1);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    Mat ds(3,1,CV_64FC1);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    Mat r1(3,1,CV_64FC1);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    Mat r2(3,1,CV_64FC1);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">while</span> ( (prevres  - res  &gt;  vanishing) ) {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        iters = iters+1;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        B.setTo(0);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        C.setTo(0);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        D.setTo(0);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        cs.setTo(0);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        ds.setTo(0);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;       </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        prevres=res;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        res=0;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int) PointsL.size(); i++) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            r1.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=PointsL[i].x;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            r1.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=PointsL[i].y;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            r1.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=1;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            r1=r1/norm(r1);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            r2.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=PointsR[i].x;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            r2.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=PointsR[i].y;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            r2.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=1;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            r2=r2/norm(r2);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            Mat r1p= Rot*r1;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            Mat ci=r1p.cross(r2);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            Mat di=r1p.cross(r2.cross(Tras));</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            Mat si=Tras.t()*ci;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;          </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            B=B+(ci*di.t());</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            D=D+(di*di.t());</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            C=C+(ci*ci.t());</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            cs=cs+ (si.at&lt;<span class="keywordtype">double</span>&gt;(0,0)*ci);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            ds=ds+ (si.at&lt;<span class="keywordtype">double</span>&gt;(0,0)*di);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            Mat residual=Tras.t()*ci*ci.t()*Tras;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            res=res+residual.at&lt;<span class="keywordtype">double</span>&gt;(0,0);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        Mat L(7,7,CV_64FC1);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        L.setTo(0);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; i++)</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                L.at&lt;<span class="keywordtype">double</span>&gt;(i,j)=C.at&lt;<span class="keywordtype">double</span>&gt;(i,j);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; i++)</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=3; j&lt;6; j++)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                L.at&lt;<span class="keywordtype">double</span>&gt;(i,j)=B.at&lt;<span class="keywordtype">double</span>&gt;(i,j-3);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;3; i++)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                L.at&lt;<span class="keywordtype">double</span>&gt;(i,6)=Tras.at&lt;<span class="keywordtype">double</span>&gt;(i,0);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=3; i&lt;6; i++)</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                Mat Bt=B.t();</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                L.at&lt;<span class="keywordtype">double</span>&gt;(i,j)=Bt.at&lt;<span class="keywordtype">double</span>&gt;(i-3,j);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=3; i&lt;6; i++)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=3; j&lt;6; j++)</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                L.at&lt;<span class="keywordtype">double</span>&gt;(i,j)=D.at&lt;<span class="keywordtype">double</span>&gt;(i-3,j-3);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++) {</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                Mat Trast=Tras.t();</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                L.at&lt;<span class="keywordtype">double</span>&gt;(6,j)=Trast.at&lt;<span class="keywordtype">double</span>&gt;(0,j);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        Mat Y(7,1,CV_64FC1);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        Y.setTo(0);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;3; j++)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                Y.at&lt;<span class="keywordtype">double</span>&gt;(j,0)=-cs.at&lt;<span class="keywordtype">double</span>&gt;(j,0);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=3; j&lt;6; j++)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                Y.at&lt;<span class="keywordtype">double</span>&gt;(j,0)=-ds.at&lt;<span class="keywordtype">double</span>&gt;(j-3,0);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        Mat Linv=L.inv();</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        Mat result=Linv*Y;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        Tras=Tras+result(Range(0,3),Range(0,1));</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        Tras=Tras/norm(Tras);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        Mat q(4,1,CV_64FC1);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        Mat temp=result(Range(3,6),Range(0,1));       </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        q.at&lt;<span class="keywordtype">double</span>&gt;(0,0)= sqrt(1-(0.25* norm(temp)*norm(temp)));</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        q.at&lt;<span class="keywordtype">double</span>&gt;(1,0)= 0.5*result.at&lt;<span class="keywordtype">double</span>&gt;(3,0);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        q.at&lt;<span class="keywordtype">double</span>&gt;(2,0)= 0.5*result.at&lt;<span class="keywordtype">double</span>&gt;(4,0);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        q.at&lt;<span class="keywordtype">double</span>&gt;(3,0)= 0.5*result.at&lt;<span class="keywordtype">double</span>&gt;(5,0);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        Mat deltaR(3,3,CV_64FC1);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <a class="code" href="classStereoCamera.html#a13fc8d5d205e09ab3d1bb8010829b0c1">getRotation</a>(q,deltaR);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        Rot=deltaR*Rot;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        SVD dec(Rot);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        Mat Id = Mat::eye(3, 3, CV_64F);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        Mat Vt=dec.vt;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        Mat U=dec.u;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        Rot=U*Id*Vt;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a13fc8d5d205e09ab3d1bb8010829b0c1"><div class="ttname"><a href="classStereoCamera.html#a13fc8d5d205e09ab3d1bb8010829b0c1">StereoCamera::getRotation</a></div><div class="ttdeci">const Mat getRotation()</div><div class="ttdoc">It returns the rotation matrix between the two cameras. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01490">stereoCamera.cpp:1490</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a36dae897d07544e8faca8c90216173a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::hornRelativeOrientations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the horn relative orientations, all the parameters are assumed initialized in the <a class="el" href="classStereoCamera.html" title="The base class defining stereo camera. ">StereoCamera</a> object. </p>
<p>The new output Rotation and Translation matrices are stored in the R and T members. </p>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01563">1563</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l01624">horn()</a>.</p>
<div class="fragment"><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                                            {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span>(this-&gt;PointsL.size()&lt;10 || this-&gt;PointsR.size()&lt;10) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;No matches found! Run findMatch fist!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordflow">if</span>(this-&gt;Kleft.empty() || this-&gt;Kright.empty() || this-&gt;R.empty() || this-&gt;T.empty()) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Cameras are empty, run Calibration first&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="keywordflow">if</span>(InliersL.empty()) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        InliersL=PointsL;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        InliersR=PointsR;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    Mat Rot=this-&gt;R.clone();</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    Mat Tras=this-&gt;T.clone();</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="classStereoCamera.html#adf155975709fdbf09d3133899d074a02">horn</a>(this-&gt;Kleft,this-&gt;Kright,this-&gt;InliersL,this-&gt;InliersR,Rot,Tras);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    this-&gt;R=Rot.clone();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    this-&gt;Rinit=Rot.clone();</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    this-&gt;T=Tras/norm(Tras)*norm(T);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    this-&gt;Tinit=Tras/norm(Tras)*norm(Tinit);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    this-&gt;updatePMatrix();</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_adf155975709fdbf09d3133899d074a02"><div class="ttname"><a href="classStereoCamera.html#adf155975709fdbf09d3133899d074a02">StereoCamera::horn</a></div><div class="ttdeci">void horn(Mat &amp;K1, Mat &amp;K2, vector&lt; Point2f &gt; &amp;Points1, vector&lt; Point2f &gt; &amp;Points2, Mat &amp;Rot, Mat &amp;Tras)</div><div class="ttdoc">It performs the horn relative orientations algorithm i.e. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01624">stereoCamera.cpp:1624</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2fcd3e1767bcf04716b0e2ac76098430"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point3f StereoCamera::metricTriangulation </td>
          <td>(</td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thMeters</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the metric triangulation given the pixel coordinates on the first image. </p>
<p>Run compute disparity before using this method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">point1</td><td>the pixel coordinates in the first image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a metric 3D point w.r.t. the first camera reference system. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01875">1875</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l00380">getDisparity16()</a>, and <a class="el" href="stereoCamera_8cpp_source.html#l01837">getMapperL()</a>.</p>
<div class="fragment"><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                                                                          {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    mutex-&gt;wait();</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">if</span>(Q.empty() || Disparity16.empty()) {</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Run computeDisparity() method first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        Point3f point;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="keywordtype">int</span> u=(int) point1.x; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordtype">int</span> v=(<span class="keywordtype">int</span>) point1.y;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    Point3f point;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">// Mapping from Rectified Cameras to Original Cameras</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    Mat Mapper=this-&gt;<a class="code" href="classStereoCamera.html#a6d7a3361adfda3a05eea2d5116ed2515">getMapperL</a>();</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span>(Mapper.empty()) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;       </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordtype">float</span> usign=Mapper.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[2*u];</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordtype">float</span> vsign=Mapper.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[2*u+1]; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    u=cvRound(usign);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    v=cvRound(vsign);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    IplImage disp16=this-&gt;<a class="code" href="classStereoCamera.html#a89f9890f50d85be9ebda7a0769279348">getDisparity16</a>();</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">if</span>(u&lt;0 || u&gt;=disp16.width || v&lt;0 || v&gt;=disp16.height) {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    CvScalar scal=cvGet2D(&amp;disp16,v,u);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordtype">double</span> disparity=scal.val[0]/16.0;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordtype">float</span> w= (float) ((<span class="keywordtype">float</span>) disparity*Q.at&lt;<span class="keywordtype">double</span>&gt;(3,2)) + ((float)Q.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    point.x= (float)((<span class="keywordtype">float</span>) (usign+1)*Q.at&lt;<span class="keywordtype">double</span>&gt;(0,0)) + ((<span class="keywordtype">float</span>) Q.at&lt;<span class="keywordtype">double</span>&gt;(0,3));</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    point.y=(float)((<span class="keywordtype">float</span>) (vsign+1)*Q.at&lt;<span class="keywordtype">double</span>&gt;(1,1)) + ((<span class="keywordtype">float</span>) Q.at&lt;<span class="keywordtype">double</span>&gt;(1,3));</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    point.z=(float) Q.at&lt;<span class="keywordtype">double</span>&gt;(2,3);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    point.x=point.x/w;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    point.y=point.y/w;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    point.z=point.z/w;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">// discard points far more than thMeters meters or with not valid disparity (&lt;0)</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">if</span>(point.z&gt;thMeters || point.z&lt;0) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    } </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            Mat P(3,1,CV_64FC1);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point.x;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point.y;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point.z;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            <span class="comment">// Rototranslation from rectified camera to original camera</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            P=this-&gt;getRLrect().t()*P;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            point.x=(float) P.at&lt;<span class="keywordtype">double</span>&gt;(0,0);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;            point.y=(float) P.at&lt;<span class="keywordtype">double</span>&gt;(1,0);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            point.z=(float) P.at&lt;<span class="keywordtype">double</span>&gt;(2,0);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    mutex-&gt;post();</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a89f9890f50d85be9ebda7a0769279348"><div class="ttname"><a href="classStereoCamera.html#a89f9890f50d85be9ebda7a0769279348">StereoCamera::getDisparity16</a></div><div class="ttdeci">const Mat getDisparity16()</div><div class="ttdoc">It returns the disparity image. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l00380">stereoCamera.cpp:380</a></div></div>
<div class="ttc" id="classStereoCamera_html_a6d7a3361adfda3a05eea2d5116ed2515"><div class="ttname"><a href="classStereoCamera.html#a6d7a3361adfda3a05eea2d5116ed2515">StereoCamera::getMapperL</a></div><div class="ttdeci">const Mat getMapperL()</div><div class="ttdoc">It returns the mapping between the original left camera and the rectified left camera. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01837">stereoCamera.cpp:1837</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3cf53fac6336eea107a26bd5cdbbdd03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point3f StereoCamera::metricTriangulation </td>
          <td>(</td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thMeters</em> = <code>10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the metric triangulation given the pixel coordinates on the first image. </p>
<p>The 3D Point is w.r.t the system defined by the parameter H. Run compute disparity before using this method. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">point1</td><td>the pixel coordinates in the first image. </td></tr>
    <tr><td class="paramname">H</td><td>the 4x4 rototranslation matrix of the system. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a metric 3D point w.r.t. the reference system defined by H. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01962">1962</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l00380">getDisparity16()</a>, <a class="el" href="stereoCamera_8cpp_source.html#l01837">getMapperL()</a>, and <a class="el" href="stereoCamera_8cpp_source.html#l01829">getRLrect()</a>.</p>
<div class="fragment"><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                                                                                  {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    mutex-&gt;wait();</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keywordflow">if</span>(H.empty())</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        H=H.eye(4,4,CV_64FC1);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">if</span>(Q.empty() || Disparity16.empty()) {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Run computeDisparity() method first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        Point3f point;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordtype">int</span> u=(int) point1.x; <span class="comment">// matrix starts from (0,0), pixels from (1,1)</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordtype">int</span> v=(<span class="keywordtype">int</span>) point1.y;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    Point3f point;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">// Mapping from Rectified Cameras to Original Cameras</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    Mat Mapper=this-&gt;<a class="code" href="classStereoCamera.html#a6d7a3361adfda3a05eea2d5116ed2515">getMapperL</a>();</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">if</span>(Mapper.empty()) {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordtype">float</span> usign=Mapper.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[2*u];</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordtype">float</span> vsign=Mapper.ptr&lt;<span class="keywordtype">float</span>&gt;(v)[2*u+1]; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    u=cvRound(usign);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    v=cvRound(vsign);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    IplImage disp16=this-&gt;<a class="code" href="classStereoCamera.html#a89f9890f50d85be9ebda7a0769279348">getDisparity16</a>();</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordflow">if</span>(u&lt;0 || u&gt;=disp16.width || v&lt;0 || v&gt;=disp16.height) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    CvScalar scal=cvGet2D(&amp;disp16,v,u);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordtype">double</span> disparity=scal.val[0]/16.0;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordtype">float</span> w= (float) ((<span class="keywordtype">float</span>) disparity*Q.at&lt;<span class="keywordtype">double</span>&gt;(3,2)) + ((float)Q.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    point.x= (float)((<span class="keywordtype">float</span>) (usign+1)*Q.at&lt;<span class="keywordtype">double</span>&gt;(0,0)) + ((<span class="keywordtype">float</span>) Q.at&lt;<span class="keywordtype">double</span>&gt;(0,3));</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    point.y=(float)((<span class="keywordtype">float</span>) (vsign+1)*Q.at&lt;<span class="keywordtype">double</span>&gt;(1,1)) + ((<span class="keywordtype">float</span>) Q.at&lt;<span class="keywordtype">double</span>&gt;(1,3));</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    point.z=(float) Q.at&lt;<span class="keywordtype">double</span>&gt;(2,3);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    point.x=point.x/w;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    point.y=point.y/w;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    point.z=point.z/w;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">// discard points far more than thMeters meters or with not valid disparity (&lt;0)</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordflow">if</span>(point.z&gt;thMeters || point.z&lt;0) {</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    } </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    Mat RLrectTmp=this-&gt;<a class="code" href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">getRLrect</a>().t();</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    Mat Tfake = Mat::zeros(0,3,CV_64F);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    Mat P(4,1,CV_64FC1);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point.x;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point.y;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point.z;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(3,0)=1;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    Mat Hrect=buildRotTras(RLrectTmp,Tfake);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    P=H*Hrect*P;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    point.x=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    point.y=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    point.z=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    mutex-&gt;post();</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a89f9890f50d85be9ebda7a0769279348"><div class="ttname"><a href="classStereoCamera.html#a89f9890f50d85be9ebda7a0769279348">StereoCamera::getDisparity16</a></div><div class="ttdeci">const Mat getDisparity16()</div><div class="ttdoc">It returns the disparity image. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l00380">stereoCamera.cpp:380</a></div></div>
<div class="ttc" id="classStereoCamera_html_a986686c56d4bf5381ea57b3f49338af1"><div class="ttname"><a href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">StereoCamera::getRLrect</a></div><div class="ttdeci">const Mat getRLrect()</div><div class="ttdoc">It returns the rotation matrix between the original left camera and the rectified left camera...</div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01829">stereoCamera.cpp:1829</a></div></div>
<div class="ttc" id="classStereoCamera_html_a6d7a3361adfda3a05eea2d5116ed2515"><div class="ttname"><a href="classStereoCamera.html#a6d7a3361adfda3a05eea2d5116ed2515">StereoCamera::getMapperL</a></div><div class="ttdeci">const Mat getMapperL()</div><div class="ttdoc">It returns the mapping between the original left camera and the rectified left camera. </div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01837">stereoCamera.cpp:1837</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03406c9d31c1b765a8d6ef9641222309"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; Point2f &gt; StereoCamera::projectPoints3D </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>camera</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; Point3f &gt; &amp;&#160;</td>
          <td class="paramname"><em>points3D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>H</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The method returns the 2D projection of a set of 3D points in the cartesian space to the specified camera. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">camera</td><td>"left" or "right" camera </td></tr>
    <tr><td class="paramname">point3D</td><td>the list of the 3D position in the reference frame H </td></tr>
    <tr><td class="paramname">H</td><td>the transformation from the camera reference system to the H reference system </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The 2D positions. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02113">2113</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;{</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    vector&lt;Point2f&gt; points2D;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">if</span>(this-&gt;Kleft.empty() || this-&gt;DistL.empty() || this-&gt;Kright.empty() || this-&gt;DistR.empty()) {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        cout &lt;&lt;<span class="stringliteral">&quot; Cameras are not calibrated! Run the Calibration first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="keywordflow">return</span> points2D;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">if</span>(H.empty())</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        H=H.eye(4,4,CV_64FC1);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    mutex-&gt;wait();</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;points3D.size(); i++)</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    {   </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        <span class="comment">// Apply inverse Trasformation for each point</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        Point3f point=points3D[i];</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        Mat P(4,1,CV_64FC1);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point.x;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point.y;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point.z;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        P.at&lt;<span class="keywordtype">double</span>&gt;(3,0)=1;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        P=H.inv()*P;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        point.x=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        point.y=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        point.z=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        points3D[i]=point;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    Mat cameraMatrix, distCoeff, rvec, tvec;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    rvec=Mat::zeros(3,1,CV_64FC1);</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">if</span>(camera==<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    {</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        cameraMatrix=this-&gt;Kleft;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        distCoeff=this-&gt;DistL;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        Mat R2= Mat::eye(3,3,CV_64FC1);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        Rodrigues(R2,rvec);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        tvec=Mat::zeros(3,1,CV_64FC1);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        cameraMatrix=this-&gt;Kright;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        distCoeff=this-&gt;DistR;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        Mat R2= this-&gt;R;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        Rodrigues(R2,rvec);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        tvec=this-&gt;T;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    }</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    Mat points3Mat(points3D);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    projectPoints(points3Mat,rvec,tvec,cameraMatrix,distCoeff,points2D);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    mutex-&gt;post();</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="keywordflow">return</span> points2D;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae5ac866c6d4b6c4819b01a918e7b61e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::rectifyImages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The method rectifies the two images: it transform each image plane such that pairs conjugate epipolar lines become collinear and parallel to one of the image axes (i.e. </p>
<p>there is 0 disparity on the Y axis). </p>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00386">386</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span>(this-&gt;Kleft.empty() || this-&gt;DistL.empty() || this-&gt;Kright.empty() || this-&gt;DistR.empty()) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        cout &lt;&lt;<span class="stringliteral">&quot; Cameras are not calibrated! Run the Calibration first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span>(this-&gt;imleft.empty() || this-&gt;imright.empty()) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Images are not set! set the images first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    Size img_size = this-&gt;imleft.size();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span>(cameraChanged)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        mutex-&gt;wait();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        stereoRectify(this-&gt;Kleft, this-&gt;DistL, this-&gt;Kright, this-&gt;DistR, img_size, this-&gt;R, this-&gt;T, this-&gt;RLrect, this-&gt;RRrect, this-&gt;PLrect, this-&gt;PRrect, this-&gt;Q, -1);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span>(cameraChanged)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        initUndistortRectifyMap(this-&gt;Kleft, this-&gt;DistL, this-&gt;RLrect, this-&gt;PLrect, img_size, CV_32FC1, this-&gt;map11, this-&gt;map12);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        initUndistortRectifyMap(this-&gt;Kright,  this-&gt;DistR, this-&gt;RRrect, this-&gt;PRrect, img_size, CV_32FC1, this-&gt;map21, this-&gt;map22);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    Mat img1r, img2r;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    remap(this-&gt;imleft, img1r, this-&gt;map11, this-&gt;map12, cv::INTER_LINEAR);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    remap(this-&gt;imright, img2r, this-&gt;map21,this-&gt;map22, cv::INTER_LINEAR);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    imgLeftRect=img1r;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    imgRightRect=img2r;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f06cd4b170ad0ba45b681ee93d64851"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::saveCalibration </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>extrinsicFilePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>intrinsicFilePath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It saves the calibration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">extrinsicFilePath</td><td>the path of the extrinsic parameters file </td></tr>
    <tr><td class="paramname">intrinsicFilePath</td><td>the path of the intrinsic parameters file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00306">306</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                                                                     {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>( Kleft.empty() || Kright.empty() || DistL.empty() || DistR.empty() || R.empty() || T.empty()) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Error: cameras are not calibrated! Run the calibration or set intrinsic and extrinsic parameters \n&quot;</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    FileStorage fs(intrinsicFilePath+<span class="stringliteral">&quot;.yml&quot;</span>, CV_STORAGE_WRITE);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span>( fs.isOpened() )</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        fs &lt;&lt; <span class="stringliteral">&quot;M1&quot;</span> &lt;&lt; Kleft &lt;&lt; <span class="stringliteral">&quot;D1&quot;</span> &lt;&lt; DistL &lt;&lt; <span class="stringliteral">&quot;M2&quot;</span> &lt;&lt; Kright &lt;&lt; <span class="stringliteral">&quot;D2&quot;</span> &lt;&lt; DistR;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        fs.release();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Error: can not save the intrinsic parameters\n&quot;</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    fs.open(extrinsicFilePath+<span class="stringliteral">&quot;.yml&quot;</span>, CV_STORAGE_WRITE);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span>( fs.isOpened() )</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        fs &lt;&lt; <span class="stringliteral">&quot;R&quot;</span> &lt;&lt; R &lt;&lt; <span class="stringliteral">&quot;T&quot;</span> &lt;&lt; T &lt;&lt;<span class="stringliteral">&quot;Q&quot;</span> &lt;&lt; Q;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        fs.release();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Error: can not save the intrinsic parameters\n&quot;</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    ofstream fout((intrinsicFilePath+<span class="stringliteral">&quot;.ini&quot;</span>).c_str());</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// Left Eye</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;[left]&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;fx &quot;</span> &lt;&lt; Kleft.at&lt;<span class="keywordtype">double</span>&gt;(0,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;fy &quot;</span> &lt;&lt; Kleft.at&lt;<span class="keywordtype">double</span>&gt;(1,1) &lt;&lt; endl;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;cx &quot;</span> &lt;&lt; Kleft.at&lt;<span class="keywordtype">double</span>&gt;(0,2) &lt;&lt; endl;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;cy &quot;</span> &lt;&lt; Kleft.at&lt;<span class="keywordtype">double</span>&gt;(1,2) &lt;&lt; endl;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;k1 &quot;</span> &lt;&lt; DistL.at&lt;<span class="keywordtype">double</span>&gt;(0,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;k2 &quot;</span> &lt;&lt; DistL.at&lt;<span class="keywordtype">double</span>&gt;(1,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;p1 &quot;</span> &lt;&lt; DistL.at&lt;<span class="keywordtype">double</span>&gt;(2,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;p2 &quot;</span> &lt;&lt; DistL.at&lt;<span class="keywordtype">double</span>&gt;(3,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Right Eye</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;[right]&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;fx &quot;</span> &lt;&lt; Kright.at&lt;<span class="keywordtype">double</span>&gt;(0,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;fy &quot;</span> &lt;&lt; Kright.at&lt;<span class="keywordtype">double</span>&gt;(1,1) &lt;&lt; endl;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;cx &quot;</span> &lt;&lt; Kright.at&lt;<span class="keywordtype">double</span>&gt;(0,2) &lt;&lt; endl;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;cy &quot;</span> &lt;&lt; Kright.at&lt;<span class="keywordtype">double</span>&gt;(1,2) &lt;&lt; endl;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;k1 &quot;</span> &lt;&lt; DistR.at&lt;<span class="keywordtype">double</span>&gt;(0,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;k2 &quot;</span> &lt;&lt; DistR.at&lt;<span class="keywordtype">double</span>&gt;(1,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;p1 &quot;</span> &lt;&lt; DistR.at&lt;<span class="keywordtype">double</span>&gt;(2,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    fout &lt;&lt; <span class="stringliteral">&quot;p2 &quot;</span> &lt;&lt; DistR.at&lt;<span class="keywordtype">double</span>&gt;(3,0) &lt;&lt; endl;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    fout.close();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ecb303d7b36eaf5f086d8ddebd29b95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::setExpectedPosition </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Tran</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function set the expected Rotation and Translation parameters for the current image pair. </p>
<p>They can be computed using the Kinematics. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Rot</td><td>3x3 matrix representing the rotation between the left and the right camera. </td></tr>
    <tr><td class="paramname">Tran</td><td>3x1 vector representing the translation between the left and the right camera. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02351">2351</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;{</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    R_exp=Rot;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    T_exp=Tran; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5e24f7d17a11adb4a6310df7f7e2de5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::setImages </td>
          <td>(</td>
          <td class="paramtype">IplImage *&#160;</td>
          <td class="paramname"><em>firstImg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IplImage *&#160;</td>
          <td class="paramname"><em>secondImg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It stores in memory a couple of images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstImg</td><td>the images acquired from the first (main) camera </td></tr>
    <tr><td class="paramname">secondImg</td><td>the images acquired from the second (secondary) camera </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00081">81</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                                              {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       this-&gt;imleft=left;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       this-&gt;imright=right;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a54754623497c8dddb61f520e17f465f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::setIntrinsics </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>K1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>K2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Dist1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Dist2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It sets the intrinsic parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">K1</td><td>3x3 camera matrix of the first camera. </td></tr>
    <tr><td class="paramname">K2</td><td>3x3 camera matrix of the second camera. </td></tr>
    <tr><td class="paramname">Dist1</td><td>4x1 distortion coefficients vector of the first camera. </td></tr>
    <tr><td class="paramname">Dist2</td><td>4x1 distortion coefficients vector of the second camera. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01861">1861</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l00054">StereoCamera()</a>.</p>
<div class="fragment"><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                                                                         {</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    this-&gt;mutex-&gt;wait();</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    this-&gt;Kleft=KL;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    this-&gt;Kright=KR;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    this-&gt;DistL=DistL;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    this-&gt;DistR=DistR;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">if</span>(!this-&gt;R.empty() &amp;&amp; !this-&gt;T.empty())</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        updatePMatrix();</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    this-&gt;cameraChanged=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    buildUndistortRemap();</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    this-&gt;mutex-&gt;post();</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae683fafa11ea73e4b4c278402be259b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::setMatches </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; cv::Point2f &gt; &amp;&#160;</td>
          <td class="paramname"><em>pointsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; cv::Point2f &gt; &amp;&#160;</td>
          <td class="paramname"><em>pointsR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function initialize the matches of the current image pair. </p>
<p>For example matches can be computed in GPU with higher framerate. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pointsL</td><td>vector of Point2f representing the keypoints on the left image. </td></tr>
    <tr><td class="paramname">pointsR</td><td>vector of Point2f representing the keypoints on the right image. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02343">2343</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;{</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    PointsL=pointsL;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    PointsR=pointsR;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1329b3894d527e1505618f57a1304624"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::setRotation </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Rot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It sets the rotation matrix (if known) between the first and the second camera. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Rot</td><td>the 3x3 rotation matrix. </td></tr>
    <tr><td class="paramname">mode</td><td>the following values are allowed: <b>mode=0</b> the rotation matrix R is set equal to Rot. <b>mode=1</b> the rotation matrix R is set equal to Rot*R. <b>mode=2</b> the rotation matrix R is set equal to Rot*Rinit. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01404">1404</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l00054">StereoCamera()</a>.</p>
<div class="fragment"><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                                {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    this-&gt;mutex-&gt;wait();</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span>(mul==0)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        this-&gt;R=Rot;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordflow">if</span>(mul==1)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        this-&gt;R=Rot*R;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordflow">if</span>(mul==2)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        this-&gt;R=Rot*Rinit;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">if</span>(R_exp.empty())</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;       R_exp=R;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    this-&gt;updatePMatrix();</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    this-&gt;cameraChanged=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    this-&gt;mutex-&gt;post();</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7b10f1218e8e70f47b22080ba1820d39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::setTranslation </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Tras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mul</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It sets the translation vector (if known) between the first and the second camera. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tras</td><td>the 3x1 translation matrix. </td></tr>
    <tr><td class="paramname">mode</td><td>the following values are allowed: <b>mode=0</b> the translation vector T is set equal to Tras. <b>mode=1</b> the translation vector T is set equal to Tras+T. <b>mode=2</b> the translation vector T is set equal to Tras+Tinit. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01419">1419</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l00054">StereoCamera()</a>.</p>
<div class="fragment"><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                                    {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    this-&gt;mutex-&gt;wait();</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">if</span>(mul==0)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        this-&gt;T=Tras;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span>(mul==1)</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        this-&gt;T=Tras+T;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">if</span>(mul==2)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        this-&gt;T=Tras+Tinit;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">if</span>(T_exp.empty())</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        T_exp=T;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">if</span>(!this-&gt;Kleft.empty() &amp;&amp; !this-&gt;Kright.empty())</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        this-&gt;updatePMatrix();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    this-&gt;cameraChanged=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    this-&gt;mutex-&gt;post();</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a398f45eeefe7979a834659cfbb7a6961"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::stereoCalibration </td>
          <td>(</td>
          <td class="paramtype">vector&lt; string &gt;&#160;</td>
          <td class="paramname"><em>imageList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boardWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boardHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sqsize</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the stereo camera calibration. </p>
<p>(see stereoCalibration module) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imageList</td><td>is the list containing the paths of the images with the chessboard patterns. even indices refer to Left camera images (i.e. main camera images), while odd indices refer to Right camera images. </td></tr>
    <tr><td class="paramname">boardWidth</td><td>the number of inner corners in the width direction of the chess board pattern (see stereoCalibration module) </td></tr>
    <tr><td class="paramname">boardHeight</td><td>the number of inner corners in the height direction of the chess board pattern (see stereoCalibration module) </td></tr>
    <tr><td class="paramname">sqsize</td><td>the size of the square of the chess board pattern. It is needed for a metric reconstruction. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00099">99</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                                                                                           {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    Size boardSize;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    boardSize.width=boardWidth;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    boardSize.height=boardHeight;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    runStereoCalib(imagelist, boardSize,sqsize);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a761ea623c4cde38b4fa1d798ef09b7ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point3f StereoCamera::triangulateKnownDisparity </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>H</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the metric triangulation given the pixel coordinates on the first image and the disparity between the two RECTIFIED images. </p>
<p>The 3D Point is w.r.t the system defined by the parameter H. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>the pixel x coordinate in the first image. </td></tr>
    <tr><td class="paramname">v</td><td>the pixel y coordinate in the first image. </td></tr>
    <tr><td class="paramname">d</td><td>the disparity on the x coordinate between the two rectified images. </td></tr>
    <tr><td class="paramname">H</td><td>the 4x4 rototranslation matrix of the system can be an empty matrix. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a metric 3D point w.r.t. the reference system defined by H. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l02054">2054</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>References <a class="el" href="stereoCamera_8cpp_source.html#l01829">getRLrect()</a>.</p>
<div class="fragment"><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;{</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    mutex-&gt;wait();</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordflow">if</span>(Q.empty())</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Run rectifyImages() method first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        Point3f point;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        point.x=0.0;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        point.y=0.0;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        point.z=0.0;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        mutex-&gt;post();</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">if</span>(H.empty())</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        H=H.eye(4,4,CV_64FC1);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    Point3f point;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordtype">float</span> w= (float) ((<span class="keywordtype">float</span>) d*Q.at&lt;<span class="keywordtype">double</span>&gt;(3,2)) + ((float)Q.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    point.x= (float)((<span class="keywordtype">float</span>) (u)*Q.at&lt;<span class="keywordtype">double</span>&gt;(0,0)) + ((<span class="keywordtype">float</span>) Q.at&lt;<span class="keywordtype">double</span>&gt;(0,3));</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    point.y=(float)((<span class="keywordtype">float</span>) (v)*Q.at&lt;<span class="keywordtype">double</span>&gt;(1,1)) + ((<span class="keywordtype">float</span>) Q.at&lt;<span class="keywordtype">double</span>&gt;(1,3));</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    point.z=(float) Q.at&lt;<span class="keywordtype">double</span>&gt;(2,3);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="comment">// Rectified Camera System</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    point.x=point.x/w;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    point.y=point.y/w;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    point.z=point.z/w;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="comment">// We transform to H Coordinate System</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    Mat RLrectTmp=this-&gt;<a class="code" href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">getRLrect</a>().t(); <span class="comment">// First it transform the point to the unrectified camera reference system</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    Mat Tfake = Mat::zeros(0,3,CV_64F);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    Mat P(4,1,CV_64FC1);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)=point.x;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)=point.y;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)=point.z;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    P.at&lt;<span class="keywordtype">double</span>&gt;(3,0)=1;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    Mat Hrect=buildRotTras(RLrectTmp,Tfake);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    P=H*Hrect*P;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    point.x=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(0,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    point.y=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(1,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    point.z=(float) ((<span class="keywordtype">float</span>) P.at&lt;<span class="keywordtype">double</span>&gt;(2,0)/P.at&lt;<span class="keywordtype">double</span>&gt;(3,0));</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    mutex-&gt;post();</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">return</span> point;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;}</div>
<div class="ttc" id="classStereoCamera_html_a986686c56d4bf5381ea57b3f49338af1"><div class="ttname"><a href="classStereoCamera.html#a986686c56d4bf5381ea57b3f49338af1">StereoCamera::getRLrect</a></div><div class="ttdeci">const Mat getRLrect()</div><div class="ttdoc">It returns the rotation matrix between the original left camera and the rectified left camera...</div><div class="ttdef"><b>Definition:</b> <a href="stereoCamera_8cpp_source.html#l01829">stereoCamera.cpp:1829</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c8ef84424fa111c63437a3db8f04333"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point3f StereoCamera::triangulation </td>
          <td>(</td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the triangulation using the stored in the internal P1 and P2 3x4 <a class="el" href="classCamera.html" title="The base class defining a simple camera. ">Camera</a> Matrices. </p>
<p>The triangulation obtained is not metric! Use the method metricTriangulation if you want a metric triangulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">point1</td><td>the 2D point coordinates in the first image. </td></tr>
    <tr><td class="paramname">point2</td><td>the 2D point coordinates in the second image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a 3D point wrt the first camera reference system. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l00681">681</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>

<p>Referenced by <a class="el" href="stereoCamera_8cpp_source.html#l01044">chierality()</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                                                           {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      Point3f point3D;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      Mat J=Mat(4,4,CV_64FC1);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      J.setTo(0);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;4; j++) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordtype">int</span> rowA=0;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordtype">int</span> rowB=2;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(0,j)=(pointleft.x*this-&gt;Pleft.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (this-&gt;Pleft.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(2,j)=(pointRight.x*this-&gt;Pright.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (this-&gt;Pright.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            rowA=1;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(1,j)=(pointleft.y*this-&gt;Pleft.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (this-&gt;Pleft.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(3,j)=(pointRight.y*this-&gt;Pright.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (this-&gt;Pright.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        SVD decom(J);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        Mat V= decom.vt;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        point3D.x=(float) ((<span class="keywordtype">float</span>) V.at&lt;<span class="keywordtype">double</span>&gt;(3,0))/((float) V.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        point3D.y=(float) ((<span class="keywordtype">float</span>) V.at&lt;<span class="keywordtype">double</span>&gt;(3,1))/((float) V.at&lt;<span class="keywordtype">double</span>&gt;(3,3));     </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        point3D.z=(float) ((<span class="keywordtype">float</span>) V.at&lt;<span class="keywordtype">double</span>&gt;(3,2))/((float) V.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">return</span> point3D;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab68c8d3bd07f542243d681fbe8c8c6b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point3f StereoCamera::triangulation </td>
          <td>(</td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>Camera1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>Camera2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the triangulation (HZ Chap 12.2 homogenous solution). </p>
<p>The triangulation obtained is not metric! Use the method metricTriangulation if you want a metric triangulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">point1</td><td>the 2D point coordinates in the first image. </td></tr>
    <tr><td class="paramname">point2</td><td>the 2D point coordinates in the second image. </td></tr>
    <tr><td class="paramname">Camera1</td><td>the 3x4 camera matrix of the first image. </td></tr>
    <tr><td class="paramname">Camera2</td><td>the 3x4 camera matrix of the second image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a 3D point wrt the first camera reference system. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01244">1244</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                                                                                     {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      Point3f point3D;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      Mat J=Mat(4,4,CV_64FC1);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      J.setTo(0);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;4; j++) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            <span class="keywordtype">int</span> rowA=0;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordtype">int</span> rowB=2;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(0,j)=(pointleft.x*Camera1.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (Camera1.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(2,j)=(pointRight.x*Camera2.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (Camera2.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            rowA=1;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(1,j)=(pointleft.y*Camera1.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (Camera1.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            J.at&lt;<span class="keywordtype">double</span>&gt;(3,j)=(pointRight.y*Camera2.at&lt;<span class="keywordtype">double</span>&gt;(rowB,j))- (Camera2.at&lt;<span class="keywordtype">double</span>&gt;(rowA,j));</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        SVD decom(J);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        Mat V= decom.vt;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;       <span class="comment">// printMatrix(V);</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="comment">/*Mat sol=Mat(4,1,CV_64FC1);</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">        sol.at&lt;double&gt;(0,0)=V.at&lt;double&gt;(0,0);</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">        sol.at&lt;double&gt;(1,0)=V.at&lt;double&gt;(1,1);</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">        sol.at&lt;double&gt;(2,0)=V.at&lt;double&gt;(2,2);</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">        sol.at&lt;double&gt;(3,0)=V.at&lt;double&gt;(3,3);</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">        </span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">        Mat test=J*sol;</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">        </span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">        printMatrix(test);*/</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        point3D.x=(float) ((<span class="keywordtype">float</span>) V.at&lt;<span class="keywordtype">double</span>&gt;(3,0))/((float) V.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        point3D.y=(float) ((<span class="keywordtype">float</span>) V.at&lt;<span class="keywordtype">double</span>&gt;(3,1))/((float) V.at&lt;<span class="keywordtype">double</span>&gt;(3,3));     </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        point3D.z=(float) ((<span class="keywordtype">float</span>) V.at&lt;<span class="keywordtype">double</span>&gt;(3,2))/((float) V.at&lt;<span class="keywordtype">double</span>&gt;(3,3));</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">return</span> point3D;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaef25d8723eefdbab6e27c348492126b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Point3f StereoCamera::triangulationLS </td>
          <td>(</td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>point2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>Camera1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>Camera2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It performs the least square triangulation (HZ Chap 12.2 Inhomogenous solution). </p>
<p>The triangulation obtained is not metric! Use the method metricTriangulation if you want a metric triangulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">point1</td><td>the 2D point coordinates in the first image. </td></tr>
    <tr><td class="paramname">point2</td><td>the 2D point coordinates in the second image. </td></tr>
    <tr><td class="paramname">Camera1</td><td>the 3x4 camera matrix of the first image. </td></tr>
    <tr><td class="paramname">Camera2</td><td>the 3x4 camera matrix of the second image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a 3D point wrt the first camera reference system. </dd></dl>

</div>
</div>
<a class="anchor" id="a2751f357e5fabc7099303d45425208d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StereoCamera::undistortImages </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It undistorts the images. </p>
<dl class="section note"><dt>Note</dt><dd>Set undistortion coefficients before using this method. </dd></dl>

<p>Definition at line <a class="el" href="stereoCamera_8cpp_source.html#l01377">1377</a> of file <a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                   {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span>(this-&gt;Kleft.empty() || this-&gt;DistL.empty() || this-&gt;Kright.empty() || this-&gt;DistR.empty()) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        cout &lt;&lt;<span class="stringliteral">&quot; Cameras are not calibrated! Run the Calibration first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">if</span>(this-&gt;imleft.empty() || this-&gt;imright.empty()) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Images are not set! set the images first!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    undistort(this-&gt;imleft,this-&gt;imleftund,this-&gt;Kleft,this-&gt;DistL);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    undistort(this-&gt;imright,this-&gt;imrightund,this-&gt;Kright,this-&gt;DistR);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>C:/dev/stereoVision/lib/include/iCub/stereoVision/<a class="el" href="stereoCamera_8h_source.html">stereoCamera.h</a></li>
<li>C:/dev/stereoVision/lib/src/<a class="el" href="stereoCamera_8cpp_source.html">stereoCamera.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 17 2014 11:36:08 for stereoVision by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
